<div class="container" style="position: relative; min-height: 450px;">
    <div class="row top-buffer" >
        <div class="col-md-12">
            <ol class="breadcrumb">
                <li>
                    <a [routerLink]="['/hf/screening']">HF Screenings</a>
                </li>
                <li>
                    <a [routerLink]="['/hf/screening/edit/', screeningId]">Screening</a>
                </li>
                <li>
                    <a [routerLink]="['/hf/screening/filteredResults/', screeningId]">Filters</a>
                </li>
                <li class="active">Filter Edit</li>
            </ol>
        </div>
    </div>
    <div class="row">
        <div class="row top-buffer" >
            <div class="col-md-12">
                <div class="alert alert-info" *ngIf="successMessage != null"><span>{{successMessage}}</span>
                </div>
            </div>
        </div>
        <div class="row top-buffer" >
            <div class="col-md-12">
                <div class="alert alert-danger" *ngIf="errorMessage != null"><span>{{errorMessage}}</span>
                </div>
            </div>
        </div>
    </div>

    <ul class="nav nav-tabs">
        <li *ngIf="filteredResult?.filteredResultStatistics?.finalResults != null" [class.active]="filteredResult?.filteredResultStatistics?.finalResults != null" (click)="viewFinal()">
            <a data-toggle="tab" href="#final">FINAL</a>
        </li>
        <li [class.active]="filteredResult?.filteredResultStatistics?.finalResults == null" (click)="viewProcess()">
            <a data-toggle="tab" href="#process">PROCESS</a>
        </li>
        <li *ngIf="filteredResult?.filteredResultStatistics?.archivedResults != null" (click)="viewArchived()">
            <a data-toggle="tab" href="#archived">ARCHIVED</a>
        </li>
    </ul>

    <div class="tab-content" [ngBusy]="busyGet">
        <div id="final" [class]="filteredResult?.filteredResultStatistics?.finalResults != null ? 'tab-pane fade in active' : 'tab-pane fade'" >
            <br/>
            <div>
                <button class="btn btn-danger pull-right" (click)="deleteSavedResults()">Move to archive</button>
            </div>
            <br/>

            <div>
                <h2>{{finalResult?.filteredResult?.screening?.name}}</h2>
                <h4><small>{{finalResult?.filteredResult?.screening?.date}}</small></h4>
                <hr style="height:2px;border:none;color:#ccc;background-color:#ccc;">

                <h4>Screening Parameters</h4>
                <div class="row withpadding">
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Fund AUM</span>
                        <span class="col-md-2">{{getAmountShort(filteredResult?.fundAUM)}}</span>

                    </div>
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Track Record</span>
                        <span class="col-md-2">{{filteredResult?.trackRecord}}</span>
                    </div>
                </div>
                <div class="row withpadding">
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Manager AUM</span>
                        <span class="col-md-2">{{getAmountShort(filteredResult?.managerAUM)}}</span>
                    </div>
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Lookback (returns)</span>
                        <span class="col-md-2">{{filteredResult?.lookbackReturns}}</span>
                    </div>
                </div>
                <div class="row withpadding">
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Start date</span>
                        <span class="col-md-2">{{filteredResult?.startDateMonth}}</span>
                    </div>
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Lookback (AUM)</span>
                        <span class="col-md-2">{{filteredResult?.lookbackAUM}}</span>
                    </div>
                </div>
                <br/>
                <div class="row withpadding">
                    <div class="col-md-12">
                        <div class="col-md-2" style="font-weight: bold;">Description</div>
                        <div class="col-md-10">{{filteredResult?.description}}</div>
                    </div>
                </div>
                <hr style="height:2px;border:none;color:#ccc;background-color:#ccc;">

                <h4>Screening Results</h4>
                <div class="row withpadding">
                    <div class="col-md-6">
                        <div id="finalScreeningResultsPieChart"></div>
                    </div>
                    <div class="col-md-6">
                        <div id="finalUnqualifiedFundsReasonBarChart"></div>
                    </div>
                </div>
                <hr style="height:2px;border:none;color:#ccc;background-color:#ccc;">

                <h4>Scoring Parameters</h4>
                <div class="row withpadding">
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Selected Lookback (AUM)</span>
                        <span class="col-md-2">{{finalResult?.selectedLookbackAUM}}</span>
                    </div>
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Selected Lookback (RETURNS)</span>
                        <span class="col-md-2">{{finalResult?.selectedLookbackReturn}}</span>
                    </div>
                </div>
                <br/>
                <div *ngIf="filteredResult?.filteredResultStatistics?.qualified?.length > 0">
                    <table class="table table-hover">
                        <tr>
                            <td [attr.colspan]="filteredResult?.filteredResultStatistics.qualified[0].length + 1" align="right">AUM LOOKBACK</td>
                        </tr>
                        <tr>
                            <td [attr.rowspan]="filteredResult?.filteredResultStatistics.qualified.length + 1">
                                <div align="right" style="writing-mode: vertical-rl;">RETURN LOOKBACK</div>
                            </td>
                        </tr>
                        <tr *ngFor="let row of filteredResult?.filteredResultStatistics?.qualified; let i=index" [style.background-color]="i==0 ? '#D5E1EC' : white"
                            align="right" [style.font-weight]="i==0 ? 'bold' : ''">
                            <td *ngFor="let td of row; let j=index" [style.background-color]="getCellColor(i,j)" align="center" [style.color]="white" [style.font-weight]="j==0 ? 'bold' : ''">
                                    <span *ngIf="i != 0 && j != 0 && td != 0" style="color: white"
                                          [style.border]="i - 1  == finalResult?.selectedLookbackReturn && j - 1 == finalResult?.selectedLookbackAUM ? '2px solid black' : ''">{{td}}</span>
                                <span *ngIf="i == 0 || j == 0 || td == 0">{{td}}</span>
                                <!--                                    <span style="color:red" *ngIf="i - 1  == filteredResult?.filteredResultStatistics?.finalResults?.selectedLookbackReturn && j - 1 == filteredResult?.filteredResultStatistics?.finalResults?.selectedLookbackAUM"-->
                                <!--                                          class="glyphicon glyphicon-ok"></span>-->
                            </td>
                        </tr>
                    </table>
                </div>
                <hr style="height:2px;border:none;color:#ccc;background-color:#ccc;">

                <div class="row withpadding">
                    <div class="col-md-6">
                        <div id="finalQualifiedTop50StrategiesPieChart"></div>
                    </div>
                    <div class="col-md-6">
                        <div id="finalTop50QualifiedBarChart"></div>
                    </div>
                </div>

                <div class="row withpadding top-buffer">
                    <span style="font-weight: bold;">TOP 50 Qualified funds:</span>
                    <button [disabled]="finalResult?.top50qualifiedFunds == null || finalResult?.top50qualifiedFunds.length == 0"
                            class="btn btn-sm btn-success" type="button" data-toggle="collapse"
                            data-target="#finalTop50QualifiedFundListCollapse" aria-expanded="false">
                            <span>{{finalResult?.top50qualifiedFunds != null ?
                                finalResult?.top50qualifiedFunds.length : 0}} (
                            {{finalResult?.qualifiedFunds != null ?
                                finalResult?.qualifiedFunds.length : 0}} )</span>
                    </button>
                    <div class="collapse in" id="finalTop50QualifiedFundListCollapse">
                        <div class="card card-body">
                            <table class="table table-responsive table-hover condensed-table small">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Fund ID</th>
                                    <th>Fund name</th>
                                    <th>Investment Manager</th>
                                    <th>Main Strategy</th>
                                    <th>Ann RoR</th>
                                    <th>Sortino</th>
                                    <th>Beta</th>
                                    <th>CF Var 99</th>
                                    <th>Alpha</th>
                                    <th>Omega</th>
                                    <th>TOTAL</th>
                                    <th>Fund AUM</th>
<!--                                    <th>Fund AUM</th>-->
                                    <th>Manager AUM</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let fund of finalResult?.top50qualifiedFunds; let i = index">
                                    <td>{{i + 1}}</td>
                                    <td>{{fund.fundId}}</td>
                                    <td>{{(fund.added ? '* ' : '') + fund.fundName}}</td>
                                    <td>{{fund.investmentManager}}</td>
                                    <td>{{fund.mainStrategy}}</td>
                                    <td>{{fund.annualizedReturn | number:'1.2-2'}}</td>
                                    <td>{{fund.sortino | number:'1.2-2' }}</td>
                                    <td>{{(fund.beta | number:'1.1-1') == 0.0 ? (fund.beta > 0 ? 0.1 : -0.1) : (fund.beta | number:'1.1-1')}}</td>
                                    <td>{{fund.cfVar| number:'1.2-2'}}</td>
                                    <td>{{fund.alpha| number:'1.2-2'}}</td>
                                    <td>{{fund.omega| number:'1.2-2'}}</td>
                                    <td style="background-color: #f9eaea;">{{fund.totalScore| number:'1.2-2'}}</td>
                                    <td>{{getAmountShort(fund.fundAUM)}}</td>
<!--                                    <td>{{getAmountShort(fund.strategyAUM)}}</td>-->
                                    <td>{{getAmountShort(fund.managerAUM)}}</td>
                                </tr>
                                <tr>
                                    <td colspan="4">* - manually added fund</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row withpadding top-buffer">
                    <span style="font-weight: bold;">Other Qualified funds:</span>
                    <button [disabled]="finalResult?.qualifiedFunds == null || finalResult?.qualifiedFunds.length == 0"
                            class="btn btn-sm btn-success" type="button" data-toggle="collapse"
                            data-target="#finalQualifiedFundListCollapse" aria-expanded="false">
                            <span>{{finalResult?.qualifiedFunds != null ?
                                (finalResult?.qualifiedFunds.length - finalResult?.top50qualifiedFunds.length) : 0}}
                             ({{finalResult?.qualifiedFunds != null ?
                                finalResult?.qualifiedFunds.length : 0}})</span>
                    </button>

                    <div class="collapse" id="finalQualifiedFundListCollapse">
                        <div class="card card-body">
                            <table class="table table-responsive table-hover condensed-table small">
                                <thead>
                                <tr>
                                    <th >#</th>
                                    <th>Fund ID</th>
                                    <th>Fund name</th>
                                    <th>Investment Manager</th>
                                    <th>Main Strategy</th>
                                    <th>Ann RoR</th>
                                    <th>Sortino</th>
                                    <th>Beta</th>
                                    <th>CF Var 99</th>
                                    <th>Alpha</th>
                                    <th>Omega</th>
                                    <th>TOTAL</th>
                                    <th>Fund AUM</th>
<!--                                    <th>Strategy AUM</th>-->
                                    <th>Manager AUM</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let fund of finalResult?.qualifiedFunds | slice:finalResult?.top50qualifiedFunds.length ; let i = index">
                                    <td>{{i + finalResult?.top50qualifiedFunds.length + 1}}</td>
                                    <td>{{fund.fundId}}</td>
                                    <td>{{fund.fundName}}</td>
                                    <td>{{fund.investmentManager}}</td>
                                    <td>{{fund.mainStrategy}}</td>
                                    <td>{{fund.annualizedReturn | number:'1.2-2'}}</td>
                                    <td>{{fund.sortino | number:'1.2-2' }}</td>
                                    <td>{{(fund.beta | number:'1.1-1') == 0.0 ? (fund.beta > 0 ? 0.1 : -0.1) : (fund.beta | number:'1.1-1')}}</td>
                                    <td>{{fund.cfVar| number:'1.2-2'}}</td>
                                    <td>{{fund.alpha| number:'1.2-2'}}</td>
                                    <td>{{fund.omega| number:'1.2-2'}}</td>
                                    <td style="background-color: #f9eaea">{{fund.totalScore| number:'1.2-2'}}</td>
                                    <td>{{getAmountShort(fund.fundAUM)}}</td>
<!--                                    <td>{{getAmountShort(fund.strategyAUM)}}</td>-->
                                    <td>{{getAmountShort(fund.managerAUM)}}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row withpadding top-buffer">
                    <span style="font-weight: bold;">Unqualified funds:</span>

                    <button [disabled]="finalResult?.unqualifiedFunds == null || finalResult?.unqualifiedFunds.length == 0"
                            class="btn btn-sm btn-danger" type="button" data-toggle="collapse"
                            data-target="#finalUnqualifiedFundListCollapse" aria-expanded="false" aria-controls="finalUnqualifiedFundListCollapse">
                            <span>{{finalResult?.unqualifiedFunds != null ?
                                finalResult?.unqualifiedFunds.length : 0}}</span>
                    </button>
                    <div class="collapse" id="finalUnqualifiedFundListCollapse">
                        <div class="card card-body">
                            <table class="table table-responsive table-hover condensed-table small">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Fund ID</th>
                                    <th>Fund name</th>
                                    <th>Investment Manager</th>
                                    <th>Main Strategy</th>
                                    <th>Fund AUM</th>
<!--                                    <th>Strategy AUM</th>-->
                                    <th>Manager AUM</th>
                                    <th>Track record</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let fund of finalResult?.unqualifiedFunds; let i = index">
                                    <td>{{i + 1}}</td>
                                    <td>{{fund.fundId}}</td>
                                    <td>{{fund.fundName}}</td>
                                    <td>{{fund.investmentManager}}</td>
                                    <td>{{fund.mainStrategy}}</td>
                                    <td>
                                        <!--                                            {{getAmountShort(fund.fundAUM)}}-->
                                        <span *ngIf="fund.fundAUM != null" [style.text-decoration]="fund.editedFundAUM != null ? 'line-through' : ''" data-toggle="tooltip"
                                              data-placement="top" title="{{fund.fundAUM}}">
                                            ${{getAmountShort(fund.fundAUM)}}
                                            <span class="glyphicon glyphicon-calendar"
                                                  *ngIf="fund?.fundAUMDate != null"
                                                  data-toggle="tooltip" data-placement="top" title="{{fund.fundAUMDate}}">
                                            </span>
                                            </span>
                                        <span *ngIf="fund.editedFundAUM != null" data-placement="top" [style.border]="'1px solid black'" title="{{fund.editedFundAUM}}" >
                                                ${{getAmountShort(fund.editedFundAUM)}}
                                                <span class="glyphicon glyphicon-calendar"
                                                      *ngIf="fund?.editedFundAUMDate != null"
                                                      data-toggle="tooltip" data-placement="top" title="{{fund.editedFundAUMDate}}">
                                                </span>
                                            </span>
                                        <span *ngIf="fund.fundAUM == null && fund.recentFundAUM != null">
                                                $ {{getAmountShort(fund.recentFundAUM)}} {{(fund.recentFundAUMDate != null ? "(" + getReportDateShortFormatted(fund.recentFundAUMDate) + ")" : '')}}
                                            </span>

                                        <span *ngIf="fund.currency != null && fund.currency.code != null && fund.currency.code != 'USD'"> <!--[style.color]="fundAUMByCurrency != null ? 'black' : 'red'">-->
                                            {{fund.currency.code + ' ' + getAmountShort(fund.fundAUMByCurrency)}}
                                            </span>
                                        <span class="glyphicon glyphicon-calendar"
                                              *ngIf="fund?.fundAUMDate != null && fund.fundAUM == null"
                                              data-toggle="tooltip" data-placement="top" title="{{fund.fundAUMDate}}">
                                            </span>
                                    </td>
<!--                                    <td>-->
<!--                                        &lt;!&ndash;                                            {{getAmountShort(fund.strategyAUM)}}&ndash;&gt;-->
<!--                                        <span style="color:green" *ngIf="fund.fundAUMCheck" class="glyphicon glyphicon-ok"></span>-->
<!--                                        <span style="color:red" *ngIf="!fund.fundAUMCheck" class="glyphicon glyphicon-remove"></span>-->
<!--                                        &nbsp;&nbsp;-->
<!--                                        <span *ngIf="fund?.strategyAUM != null">-->
<!--                                                {{getAmountShort(fund.strategyAUM)}}-->
<!--                                            </span>-->
<!--                                        <span *ngIf="fund.strategyAUM == null && fund.recentStrategyAUM != null">-->
<!--                                                {{getAmountShort(fund.recentStrategyAUM)}} {{fund.recentStrategyAUMDate != null ? getReportDateShortFormatted(fund.recentStrategyAUMDate) : ''}}-->
<!--                                            </span>-->
<!--                                        <span class="glyphicon glyphicon-exclamation-sign"-->
<!--                                              *ngIf="fund.strategyAUMWithMissingCurrency"-->
<!--                                              data-toggle="tooltip" data-placement="top" title="Currency rates missing for some of the Manager funds">-->
<!--                                            </span>-->
<!--                                    </td>-->
                                    <td>
                                        <!--                                            {{getAmountShort(fund.managerAUM)}}-->
                                        <span style="color:green" *ngIf="fund.managerAUMCheck" class="glyphicon glyphicon-ok"></span>
                                        <span style="color:red" *ngIf="!fund.managerAUMCheck" class="glyphicon glyphicon-remove"></span>
                                        &nbsp;&nbsp;
                                        {{fund.managerAUM != null ? getAmountShort(fund.managerAUM) : 'N/A'}} &nbsp;
                                    </td>
                                    <td>
                                        <span style="color:green" *ngIf="fund.trackRecordCheck" class="glyphicon glyphicon-ok"></span>
                                        <span style="color:red" *ngIf="!fund.trackRecordCheck" class="glyphicon glyphicon-remove"></span>
                                        {{getReportDateShortFormatted(fund.recentTrackRecordDate) }}
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row withpadding top-buffer">
                    <span style="font-weight: bold;">Undecided funds:</span>

                    <button [disabled]="finalResult?.undecidedFunds == null || finalResult?.undecidedFunds.length == 0"
                            class="btn btn-sm btn-secondary" type="button" data-toggle="collapse"
                            data-target="#finalUndecidedFundListCollapse" aria-expanded="false" aria-controls="finalUndecidedFundListCollapse">
                            <span>{{finalResult?.undecidedFunds != null ?
                                finalResult?.undecidedFunds.length : 0}}</span>
                    </button>

                    <div class="collapse" id="finalUndecidedFundListCollapse">
                        <div class="card card-body">
                            <table class="table table-responsive table-hover condensed-table small">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Fund ID</th>
                                    <th>Fund name</th>
                                    <th>Investment Manager</th>
                                    <th>Main Strategy</th>
                                    <th>Fund AUM</th>
<!--                                    <th>Strategy AUM</th>-->
                                    <th>Manager AUM</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let fund of finalResult?.undecidedFunds; let i = index">
                                    <td>{{i + 1}}</td>
                                    <td>{{fund.fundId}}</td>
                                    <td>{{fund.fundName}}</td>
                                    <td>{{fund.investmentManager}}</td>
                                    <td>{{fund.mainStrategy}}</td>
                                    <td>{{getAmountShort(fund.fundAUM)}}</td>
<!--                                    <td>{{getAmountShort(fund.strategyAUM)}}</td>-->
                                    <td>{{getAmountShort(fund.managerAUM)}}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <hr style="height:2px;border:none;color:#ccc;background-color:#ccc;">

                <h4>OTHER DATA </h4>
                <div class="row withpadding top-buffer">
                    <span style="font-weight: bold;">Edited funds:</span>
                    <button [disabled]="finalResult?.editedFunds == null || finalResult?.editedFunds.length == 0"
                            class="btn btn-sm btn-success" type="button" data-toggle="collapse"
                            data-target="#finalEditedFundListCollapse" aria-expanded="false">
                            <span>{{finalResult?.editedFunds != null ?
                                finalResult?.editedFunds.length : 0}}</span>
                    </button>
                    <div class="collapse" id="finalEditedFundListCollapse">
                        <div class="card card-body">
                            <table class="table table-responsive table-hover condensed-table small">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Fund ID</th>
                                    <th>Fund name</th>
                                    <th>Investment Manager</th>
                                    <th>Main Strategy</th>
<!--                                    <th>Ann RoR</th>-->
<!--                                    <th>Sortino</th>-->
<!--                                    <th>Beta</th>-->
<!--                                    <th>CF Var 99</th>-->
<!--                                    <th>Alpha</th>-->
<!--                                    <th>Omega</th>-->
<!--                                    <th>TOTAL</th>-->
                                    <th>Fund AUM</th>
<!--                                    <th>Strategy AUM</th>-->
                                    <th>Manager AUM</th>
                                    <th>Comment</th>
                                    <th>&nbsp;</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let fund of finalResult?.editedFunds; let i = index">
                                    <td>{{i + 1}}</td>
                                    <td>{{fund.fundId}}</td>
                                    <td><span [style.text-decoration]="fund.excluded ? 'line-through' : ''">{{fund.fundName}}</span></td>
                                    <td>{{fund.investmentManager}}</td>
                                    <td>{{fund.mainStrategy}}</td>
<!--                                    <td>{{fund.annualizedReturn | percent:'1.2-2'}}</td>-->
<!--                                    <td>{{fund.sortino | number:'1.2-2' }}</td>-->
<!--                                    <td>{{(fund.beta | number:'1.1-1') == 0.0 ? (fund.beta > 0 ? 0.1 : -0.1) : (fund.beta | number:'1.1-1')}}</td>-->
<!--                                    <td>{{fund.cfVar| percent:'1.2-2'}}</td>-->
<!--                                    <td>{{fund.alpha| percent:'1.2-2'}}</td>-->
<!--                                    <td>{{fund.omega| number:'1.2-2'}}</td>-->
<!--                                    <td style="background-color: #f9eaea;">{{fund.totalScore| number:'1.2-2'}}</td>-->
                                    <td>{{getAmountShort(fund.editedFundAUM)}}</td>
<!--                                    <td>{{getAmountShort(fund.strategyAUM)}}</td>-->
                                    <td>{{getAmountShort(fund.managerAUM)}}</td>
                                    <td>{{fund.editedFundAUMComment}}</td>
                                    <td>{{fund.excluded? 'EXCLUDED' : ''}}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row withpadding top-buffer">
                    <span style="font-weight: bold;">Benchmarks:</span>
                    <button [disabled]="finalResult?.benchmarks == null || finalResult?.benchmarks.length == 0"
                            class="btn btn-sm btn-success" type="button" data-toggle="collapse"
                            data-target="#finalBenchmarksListCollapse" aria-expanded="false">
                            <span>{{finalResult?.benchmarks != null ?
                                finalResult?.benchmarks.length : 0}}</span>
                    </button>
                    <div class="collapse" id="finalBenchmarksListCollapse">
                        <div class="card card-body">
                            <table class="table table-responsive table-hover condensed-table small">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Benchmark</th>
                                    <th>Date</th>
                                    <th>Return Value</th>
                                    <th>YTD</th>
                                    <th>&nbsp;</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let benchmark of finalResult?.benchmarks; let i = index">
                                    <td>{{i + 1}}</td>
                                    <td>{{benchmark?.benchmark?.nameEn}}</td>
                                    <td>{{benchmark.date}}</td>
                                    <td>{{benchmark.calculatedMonthReturn}}</td>
                                    <td>{{benchmark.ytd}}</td>
                                    <td>&nbsp;</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row withpadding top-buffer">
                    <span style="font-weight: bold;">Currency Rates:</span>
                    <button [disabled]="finalResult?.currencyRates == null || finalResult?.currencyRates.length == 0"
                            class="btn btn-sm btn-success" type="button" data-toggle="collapse"
                            data-target="#finalCurrencyRatesListCollapse" aria-expanded="false">
                            <span>{{finalResult?.currencyRates != null ?
                                finalResult?.currencyRates.length : 0}}</span>
                    </button>
                    <div class="collapse" id="finalCurrencyRatesListCollapse">
                        <div class="card card-body">
                            <table class="table table-responsive table-hover condensed-table small">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Currency</th>
                                    <th>Date</th>
                                    <th>Value USD</th>
                                    <th>Value KZT</th>
                                    <th>Avg Month Value</th>
                                    <th>Ag Year Value</th>
                                    <th>&nbsp;</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let currencyRate of finalResult?.currencyRates; let i = index">
                                    <td>{{i + 1}}</td>
                                    <td>{{currencyRate?.currency?.nameEn}}</td>
                                    <td>{{currencyRate.date}}</td>
                                    <td>{{currencyRate.valueUSD}}</td>
                                    <td>{{currencyRate.value}}</td>
                                    <td>{{currencyRate.averageValue}}</td>
                                    <td>{{currencyRate.averageValueYear}}</td>
                                    <td>&nbsp;</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="process" [class]="filteredResult?.filteredResultStatistics?.finalResults == null ? 'tab-pane fade in active' : 'tab-pane fade'" >
            <br/>
            <div class="row withpadding" style="position: relative; min-height: 80px;">
                <form (ngSubmit)="saveFilters()" #paramsForm="ngForm">
                    <div class="col-md-12">
                        <div class="col-md-6">
                            <table class="table table-hover">
                                <tr>
                                    <td>Fund AUM,$</td>
                                    <td><input class="form-control"  required type="text" name="fundAUM" [(ngModel)]="filteredResult.fundAUM"
                                               [disabled]="!filteredResult?.editable"
                                               (keyup)="onNumberChangeFundAUM()"/></td>
                                </tr>
                                <tr>
                                    <td>Manager AUM,$</td>
                                    <td><input class="form-control"  required type="text" name="managerAUM" [(ngModel)]="filteredResult.managerAUM"
                                               [disabled]="!filteredResult?.editable"
                                               (keyup)="onNumberChangeManagerAUM()"/></td>
                                </tr>
                                <tr>
                                    <td>Lookback date from</td>
                                    <td>
                                        <div class='input-group date col-md-2' id='startDateTPickeer' style="width: 100%">
                                            <input type='text' class="form-control" id="startDate" name="startDate" [(ngModel)]="filteredResult.startDateMonth"
                                                   [disabled]="!filteredResult?.editable"/>
                                            <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar"></span>
                                        </span>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-md-6">
                            <table class="table table-hover">
                                <tr>
                                    <td>Track Record (months)</td>
                                    <td><input class="form-control" required type="text" name="trackRecord" [(ngModel)]="filteredResult.trackRecord"
                                               [disabled]="!filteredResult?.editable"/></td>
                                </tr>
                                <tr>
                                    <td>Lookback Returns (months)</td>
                                    <td><input class="form-control" required type="text" name="lookbackReturns" [(ngModel)]="filteredResult.lookbackReturns"
                                               [disabled]="!filteredResult?.editable"/></td>
                                </tr>
                                <tr>
                                    <td>Lookback AUM (months)</td>
                                    <td><input class="form-control" required type="text" name="lookbackAUM" [(ngModel)]="filteredResult.lookbackAUM"
                                               [disabled]="!filteredResult?.editable"/></td>
                                </tr>
<!--                                <tr>-->
<!--                                    <td colspan="2">-->
<!--                                        <button type="button" class="btn btn-success pull-right" [disabled]="!paramsForm.form.valid || !filteredResult?.editable" (click)="saveFilters()">SAVE</button>-->
<!--                                    </td>-->
<!--                                </tr>-->
                            </table>
                        </div>
                    </div>

                    <div class="row withpadding">
                        <div class="col-md-2">
                            <label> Description</label>
                        </div>
                        <div class="col-md-8">
                            <input  class="form-control" [disabled]="!filteredResult?.editable" placeholder="Enter description ..."  type="text" name="description" [(ngModel)]="filteredResult.description"/>
                        </div>
                        <div class="col-md-2">
                            <button type="button" class="btn btn-success pull-right" [disabled]="!paramsForm.form.valid || !filteredResult?.editable" (click)="saveFilters()">SAVE</button>
                        </div>
                    </div>
                </form>
                <br/>
                <div>
                    <button type="submit" *ngIf="filteredResult != null && filteredResult.id > 0" class="btn btn-primary pull-right" [disabled]="!paramsForm.form.valid" (click)="applyFilters()">APPLY</button>
                </div>
                <br/>
            </div>

            <div [ngBusy]="busyStats">
                <div *ngIf="filteredResult?.filteredResultStatistics != null">
                    <ul class="nav nav-tabs">
                        <li class="active">
                            <a data-toggle="tab" href="#qualified">QUALIFIED</a>
                        </li>
                        <li>
                            <a data-toggle="tab" href="#unqualified">UNQUALIFIED</a>
                        </li>
                        <li>
                            <a data-toggle="tab" href="#undecided">UNDECIDED</a>
                        </li>
<!--                        <li *ngIf="filteredResult?.filteredResultStatistics?.finalResults != null">-->
<!--                            <a data-toggle="tab" href="#final"  (click)="viewFinalResultsTab()">FINAL</a>-->
<!--                        </li>-->
                    </ul>
                    <div class="tab-content">
                        <div id="qualified" class="tab-pane fade in active">
                            <br/>
                            <div class="row withpadding">
                                <div *ngIf="filteredResult?.filteredResultStatistics?.qualified?.length > 0">
                                    <table class="table table-hover">
                                        <tr>
                                            <td [attr.colspan]="filteredResult.filteredResultStatistics.qualified[0].length + 1" style="font-weight: bold" align="right">AUM LOOKBACK</td>
                                        </tr>
                                        <tr>
                                            <td [attr.rowspan]="filteredResult.filteredResultStatistics.qualified.length + 1" style="font-weight: bold;">
                                                <div align="right" style="writing-mode: vertical-rl;">RETURN LOOKBACK</div>
                                            </td>
                                        </tr>
                                        <tr *ngFor="let row of filteredResult?.filteredResultStatistics?.qualified; let i=index" [style.background-color]="i==0 ? '#D5E1EC' : white"
                                            align="right" [style.font-weight]="i==0 ? 'bold' : ''">
                                            <td *ngFor="let td of row; let j=index" [style.background-color]="getCellColor(i,j)" align="center" [style.color]="white" [style.font-weight]="j==0 ? 'bold' : ''">
                                                <a *ngIf="i != 0 && j != 0 && td != 0" (click)="showFunds(i-1, j-1, 1, td, false)" style="color: white" data-toggle="modal" data-target="#fundListModal">{{td}}</a>
                                                <span *ngIf="i == 0 || j == 0 || td == 0">{{td}}</span>
                                            </td>
                                        </tr>
                                        <!--                                <tr>-->
                                        <!--                                    <td [attr.colspan]="filteredResult.filteredResultStatistics.qualified.length" style="font-weight: bold" align="left">RETURN LOOKBACK</td>-->
                                        <!--                                </tr>-->
                                    </table>
                                </div>
                            </div>

                            <br/>
                            <h4>Alternative Scoring</h4>
                            <div class="row withpadding">
                                <div *ngIf="filteredResult?.filteredResultStatistics?.qualified?.length > 0">
                                    <table class="table table-hover">
                                        <tr>
                                            <td [attr.colspan]="filteredResult.filteredResultStatistics.qualified[0].length + 1" style="font-weight: bold" align="right">AUM LOOKBACK</td>
                                        </tr>
                                        <tr>
                                            <td [attr.rowspan]="filteredResult.filteredResultStatistics.qualified.length + 1" style="font-weight: bold;">
                                                <div align="right" style="writing-mode: vertical-rl;">RETURN LOOKBACK</div>
                                            </td>
                                        </tr>
                                        <tr *ngFor="let row of filteredResult?.filteredResultStatistics?.qualified; let i=index" [style.background-color]="i==0 ? '#D5E1EC' : white"
                                            align="right" [style.font-weight]="i==0 ? 'bold' : ''">
                                            <td *ngFor="let td of row; let j=index" [style.background-color]="getCellColor(i,j)" align="center" [style.color]="white" [style.font-weight]="j==0 ? 'bold' : ''">
                                                <a *ngIf="i != 0 && j != 0 && td != 0" (click)="showFunds(i-1, j-1, 1, td, true)" style="color: white" data-toggle="modal" data-target="#fundListModal">{{td}}</a>
                                                <span *ngIf="i == 0 || j == 0 || td == 0">{{td}}</span>
                                            </td>
                                        </tr>
                                        <!--                                <tr>-->
                                        <!--                                    <td [attr.colspan]="filteredResult.filteredResultStatistics.qualified.length" style="font-weight: bold" align="left">RETURN LOOKBACK</td>-->
                                        <!--                                </tr>-->
                                    </table>
                                </div>
                            </div>

                            <h4>Added Funds</h4>
                            <div class="row withpadding">
                        <span *ngIf="selectedFund == null && filteredResult.editable" class="btn btn-sm btn-primary pull-right" (click)="editFund()"
                              data-toggle="modal" data-target="#fundEditModal">Add fund
                                <span class="glyphicon glyphicon-plus"></span>
                        </span>
                            </div>
                            <div class="row" *ngIf="filteredResult.addedFunds != null && filteredResult.addedFunds.length > 0">
                                <table class="table table-hover small">
                                    <thead>
                                    <tr>
                                        <th width="5%">#</th>
                                        <th width="10%">FUND ID</th>
                                        <th width="15%">FUND NAME</th>
                                        <th width="15%">INVESTMENT MANAGER</th>
                                        <!--                                <th width="10%">MAIN STRATEGY</th>-->
                                        <th width="10%">FUND STATUS</th>
                                        <th width="10%">FUND AUM,$</th>
                                        <th width="10%">MANAGER AUM,$</th>
                                        <th width="20%">COMMENT</th>
                                        <th width="5%">&nbsp;</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr *ngFor="let fund of filteredResult.addedFunds; let i=index">
                                        <td>{{i + 1}}</td>
                                        <td>{{fund.fundId}}</td>
                                        <td>{{fund.fundName}}</td>
                                        <td>{{fund.investmentManager}}</td>
                                        <!--                                <td>{{fund.mainStrategy}}</td>-->
                                        <td>{{fund.fundStatus}}</td>
                                        <td>{{getAmountShort(fund.fundAUM)}}</td>
                                        <td>{{getAmountShort(fund.managerAUM)}}</td>
                                        <td>{{fund.fundAUMComment}}</td>
<!--                                        <td>&nbsp;</td>-->
                                        <td>
                                            <div *ngIf="filteredResult.editable">
                                                <span (click)="editFund(fund)" data-toggle="modal" data-target="#fundEditModal">
                                                    <span class="glyphicon glyphicon-pencil"></span>
                                                </span>
                                                &nbsp;
                                                <span (click)="removeFund(fund)">
                                                    <span class="glyphicon glyphicon-trash"></span>
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <span *ngIf="filteredResult.addedFunds == null || filteredResult.addedFunds.length == 0"><i>No funds added</i></span>

                            <h4>Edited Funds</h4>
                            <div class="row" *ngIf="filteredResult.editedFunds != null && filteredResult.editedFunds.length > 0">
                                <table class="table table-hover small">
                                    <thead>
                                    <tr>
                                        <th width="5%">#</th>
                                        <th width="10%">FUND ID</th>
                                        <th width="15%">FUND NAME</th>
                                        <th width="15%">INVESTMENT MANAGER</th>
                                        <th width="10%">EDITED FUND AUM,$</th>
                                        <th width="10%">EDITED FUND AUM DATE</th>
                                        <th width="20%">EDITED FUND AUM COMMENT</th>
                                        <th width="10%">EDITED MANAGER AUM,$</th>
<!--                                        <th width="20%">COMMENT</th>-->
                                        <th width="5%">&nbsp;</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr *ngFor="let fund of filteredResult.editedFunds; let i=index">
                                        <td>{{i + 1}}</td>
                                        <td>{{fund.fundId}}</td>
                                        <td>{{fund.fundName}}</td>
                                        <td>{{fund.investmentManager}}</td>
                                        <td>{{getAmountShort(fund.editedFundAUM)}}</td>
                                        <td>{{fund.editedFundAUMDate}}</td>
                                        <td>{{fund.editedFundAUMComment}}</td>
                                        <td>{{getAmountShort(fund.managerAUM)}}</td>
                                        <td>
                                            <span *ngIf="filteredResult.editable" (click)="editFund(fund)" data-toggle="modal" data-target="#fundEditModal"s>
                                                    <span class="glyphicon glyphicon-pencil"></span>
                                            </span>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <span *ngIf="filteredResult.editedFunds == null || filteredResult.editedFunds.length == 0"><i>No edited funds</i></span>

                            <h4>Excluded Funds</h4>
                            <div class="row" *ngIf="filteredResult.excludedFunds != null && filteredResult.excludedFunds.length > 0">
                                <table class="table table-hover small">
                                    <thead>
                                    <tr>
                                        <th width="5%">#</th>
                                        <th width="10%">FUND ID</th>
                                        <th width="15%">FUND NAME</th>
                                        <th width="15%">INVESTMENT MANAGER</th>
                                        <!--                                <th width="10%">MAIN STRATEGY</th>-->
                                        <th width="10%">FUND STATUS</th>
                                        <th width="10%">FUND AUM,$</th>
                                        <th width="10%">MANAGER AUM,$</th>
                                        <th width="20%">COMMENT</th>
                                        <th width="5%">&nbsp;</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr *ngFor="let fund of filteredResult.excludedFunds; let i=index">
                                        <td>{{i + 1}}</td>
                                        <td>{{fund.fundId}}</td>
                                        <td>{{fund.fundName}}</td>
                                        <td>{{fund.investmentManager}}</td>
                                        <!--                                <td>{{fund.mainStrategy}}</td>-->
                                        <td>{{fund.fundStatus}}</td>
                                        <td>
<!--                                    <span [style.text-decoration]="fund.excludeFromStrategyAUM ? 'line-through' : ''"-->
<!--                                          data-toggle="tooltip" data-placement="top" title="{{fund.excludeFromStrategyAUM ? 'Excluded from Strategy AUM calculation' : 'Included into Strategy AUM calculation'}}">-->
<!--                                        {{getAmountShort(fund.fundAUM)}}-->
<!--                                    </span>-->
                                        </td>
                                        <td>{{getAmountShort(fund.managerAUM)}}</td>
                                        <td>{{fund.excludeComment}}</td>
                                        <td>
                                    <span *ngIf="filteredResult.editable" (click)="includeFund(fund)">
                                            <span class="glyphicon glyphicon-plus"></span>
                                        </span>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <span *ngIf="filteredResult.excludedFunds == null || filteredResult.excludedFunds.length == 0"><i>No excluded funds</i></span>

                            <h4>Auto-Excluded Funds (AUM not affecting Strategy AUM)</h4>
                            <div class="row" *ngIf="filteredResult.autoExcludedFunds != null && filteredResult.autoExcludedFunds.length > 0">
                                <table class="table table-hover small">
                                    <thead>
                                    <tr>
                                        <th width="5%">#</th>
                                        <th width="10%">FUND ID</th>
                                        <th width="15%">FUND NAME</th>
                                        <th width="15%">INVESTMENT MANAGER</th>
                                        <!--                                <th width="10%">MAIN STRATEGY</th>-->
                                        <th width="10%">FUND STATUS</th>
                                        <th width="10%">FUND AUM,$</th>
                                        <th width="10%">MANAGER AUM,$</th>
                                        <th width="20%">COMMENT</th>
                                        <th width="5%">&nbsp;</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr *ngFor="let fund of filteredResult.autoExcludedFunds; let i=index" style="background-color: #DCDCDC;">
                                        <td>{{i + 1}}</td>
                                        <td>{{fund.fundId}}</td>
                                        <td>{{fund.fundName}}</td>
                                        <td>{{fund.investmentManager}}</td>
                                        <!--                                <td>{{fund.mainStrategy}}</td>-->
                                        <td>{{fund.fundStatus}}</td>
                                        <td>{{getAmountShort(fund.fundAUM)}}</td>
                                        <td>{{getAmountShort(fund.managerAUM)}}</td>
                                        <td>{{fund.excludeComment}}</td>
                                        <td>
                                    <span *ngIf="filteredResult.editable" (click)="includeFund(fund)">
                                        <span class="glyphicon glyphicon-plus"></span>
                                    </span>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <span *ngIf="filteredResult.autoExcludedFunds == null || filteredResult.autoExcludedFunds.length == 0"><i>No auto-excluded funds</i></span>
                        </div>
                        <div id="unqualified" class="tab-pane fade">
                            <br/>
                            <div class="row withpadding">
                                <div *ngIf="filteredResult?.filteredResultStatistics?.unqualified?.length > 0">
                                    <table class="table table-hover">
                                        <tr>
                                            <td [attr.colspan]="filteredResult.filteredResultStatistics.unqualified[0].length + 1" style="font-weight: bold" align="right">AUM LOOKBACK</td>
                                        </tr>
                                        <tr>
                                            <td [attr.rowspan]="filteredResult.filteredResultStatistics.unqualified.length + 1" style="font-weight: bold;">
                                                <div align="right" style="writing-mode: vertical-rl;">RETURN LOOKBACK</div>
                                            </td>
                                        </tr>
                                        <tr *ngFor="let row of filteredResult?.filteredResultStatistics?.unqualified; let i=index" [style.background-color]="i==0 ? '#D5E1EC' : white"
                                            align="right" [style.font-weight]="i==0 ? 'bold' : ''">
                                            <td *ngFor="let td of row; let j=index" [style.background-color]="getCellColor(i,j)" align="right" [style.color]="white" [style.font-weight]="j==0 ? 'bold' : ''" align="center">
                                                <a *ngIf="i != 0 && j != 0 && td != 0" (click)="showFunds(i-1, j-1, 2, td, false)" style="color: white" data-toggle="modal" data-target="#fundListModal">{{td}}</a>
                                                <span *ngIf="i == 0 || j == 0 || td == 0">{{td}}</span>
                                            </td>
                                        </tr>
                                        <!--                                <tr>-->
                                        <!--                                    <td [attr.colspan]="filteredResult.filteredResultStatistics.unqualified.length" style="font-weight: bold" align="left">RETURN LOOKBACK</td>-->
                                        <!--                                </tr>-->
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div id="undecided" class="tab-pane fade">
                            <br/>
                            <div class="row withpadding">
                                <div *ngIf="filteredResult?.filteredResultStatistics?.undecided?.length > 0">
                                    <table class="table table-hover">
                                        <tr>
                                            <td [attr.colspan]="filteredResult.filteredResultStatistics.undecided[0].length + 1" style="font-weight: bold" align="right">AUM LOOKBACK</td>
                                        </tr>
                                        <tr>
                                            <td [attr.rowspan]="filteredResult.filteredResultStatistics.undecided.length + 1" style="font-weight: bold;">
                                                <div align="right" style="writing-mode: vertical-rl;">RETURN LOOKBACK</div>
                                            </td>
                                        </tr>
                                        <tr *ngFor="let row of filteredResult?.filteredResultStatistics?.undecided; let i=index" [style.background-color]="i==0 ? '#D5E1EC' : white"
                                            align="right" [style.font-weight]="i==0 ? 'bold' : ''">
                                            <td *ngFor="let td of row; let j=index" [style.background-color]="getCellColor(i,j)" align="center" [style.color]="white" [style.font-weight]="j==0 ? 'bold' : ''">
                                                <a *ngIf="i != 0 && j != 0 && td != 0" (click)="showFunds(i-1, j-1, 3, td, false)" style="color: white" data-toggle="modal" data-target="#fundListModal">{{td}}</a>
                                                <span *ngIf="i == 0 || j == 0 || td == 0">{{td}}</span>
                                            </td>
                                        </tr>
                                        <!--                                <tr>-->
                                        <!--                                    <td [attr.colspan]="filteredResult.filteredResultStatistics.undecided.length" style="font-weight: bold" align="left">RETURN LOOKBACK</td>-->
                                        <!--                                </tr>-->
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="archived" class="tab-pane fade">
            <br/>
            <br/>
            <div class="row">
                <div class="col-md-12">
                    <label class="col-md-2" for="archiveSelect">Choose archived results: </label>
                    <div class="col-md-6">
                        <select class="form-control col-md-4" id="archiveSelect" (change)="archiveSelected($event.target.value)">
                            <option value="0">---</option>
                            <option *ngFor="let item of filteredResult?.filteredResultStatistics?.archivedResults" value="{{item.id}}">{{getFinalResultName(item)}}</option>
                        </select>
                    </div>
<!--                    <button class="btn btn-primary" (click)="loadArchivedResults()">LOAD</button>-->
                </div>
            </div>
            <br/>

            <div [hidden]="selectedArchivedResult == null">
                <div class="row">
                    <button class="btn btn-success pull-right" [disabled]="filteredResult?.filteredResultStatistics?.finalResults != null" (click)="markAsFinalArchived()">Mark as final</button>
                </div>
                <h2>{{selectedArchivedResult?.filteredResult?.screening?.name}}</h2>
                <h4><small>{{selectedArchivedResult?.filteredResult?.screening?.date}}</small></h4>
                <hr style="height:2px;border:none;color:#ccc;background-color:#ccc;">

                <h4>Screening Parameters</h4>
                <div class="row withpadding">
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Fund AUM</span>
                        <span class="col-md-2">{{getAmountShort(selectedArchivedResult?.fundAUM)}}</span>
                    </div>
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Track Record</span>
                        <span class="col-md-2">{{selectedArchivedResult?.trackRecord}}</span>
                    </div>
                </div>
                <div class="row withpadding">
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Manager AUM</span>
                        <span class="col-md-2">{{getAmountShort(selectedArchivedResult?.managerAUM)}}</span>
                    </div>
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Lookback (returns)</span>
                        <span class="col-md-2">{{selectedArchivedResult?.lookbackReturns}}</span>
                    </div>
                </div>
                <div class="row withpadding">
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Start date</span>
                        <span class="col-md-2">{{selectedArchivedResult?.startDateMonth}}</span>
                    </div>
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Lookback (AUM)</span>
                        <span class="col-md-2">{{selectedArchivedResult?.lookbackAUM}}</span>
                    </div>
                </div>
                <br/>
                <div class="row withpadding">
                    <div class="col-md-12">
                        <div class="col-md-2" style="font-weight: bold;">Description</div>
                        <div class="col-md-10">{{selectedArchivedResult?.description}}</div>
                    </div>
                </div>
                <hr style="height:2px;border:none;color:#ccc;background-color:#ccc;">

                <h4>Screening Results</h4>
                <div class="row withpadding">
                    <div class="col-md-6">
                        <div id="archivedFinalScreeningResultsPieChart"></div>
                    </div>
                    <div class="col-md-6">
                        <div id="archivedFinalUnqualifiedFundsReasonBarChart"></div>
                    </div>
                </div>
                <hr style="height:2px;border:none;color:#ccc;background-color:#ccc;">

                <h4>Scoring Parameters</h4>
                <div class="row withpadding">
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Selected Lookback (AUM)</span>
                        <span class="col-md-2">{{selectedArchivedResult?.selectedLookbackAUM}}</span>
                    </div>
                    <div class="col-md-6">
                        <span class="col-md-4" style="font-weight: bold;">Selected Lookback (RETURNS)</span>
                        <span class="col-md-2">{{selectedArchivedResult?.selectedLookbackReturn}}</span>
                    </div>
                </div>

                <br/>
                <hr style="height:2px;border:none;color:#ccc;background-color:#ccc;">

                <h4>Scoring Results</h4>
                <div class="row withpadding">
                    <div class="col-md-6">
                        <div id="archivedFinalQualifiedTop50StrategiesPieChart"></div>
                    </div>
                    <div class="col-md-6">
                        <div id="archivedFinalTop50QualifiedBarChart"></div>
                    </div>
                </div>

                <div class="row withpadding top-buffer">
                    <span style="font-weight: bold;">TOP 50 Qualified funds:</span>
                    <button [disabled]="selectedArchivedResult?.top50qualifiedFunds == null || selectedArchivedResult?.top50qualifiedFunds.length == 0"
                            class="btn btn-sm btn-success" type="button" data-toggle="collapse"
                            data-target="#archivedFinalTop50QualifiedFundListCollapse" aria-expanded="false">
                            <span>{{selectedArchivedResult?.top50qualifiedFunds != null ?
                                selectedArchivedResult?.top50qualifiedFunds.length : 0}}
                            ({{selectedArchivedResult?.qualifiedFunds != null ?
                                selectedArchivedResult?.qualifiedFunds.length : 0}})</span>
                    </button>
                    <div class="collapse in" id="archivedFinalTop50QualifiedFundListCollapse">
                        <div class="card card-body">
                            <table class="table table-responsive table-hover condensed-table small">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Fund ID</th>
                                    <th>Fund name</th>
                                    <th>Investment Manager</th>
                                    <th>Main Strategy</th>
                                    <th>Ann RoR</th>
                                    <th>Sortino</th>
                                    <th>Beta</th>
                                    <th>CF Var 99</th>
                                    <th>Alpha</th>
                                    <th>Omega</th>
                                    <th>TOTAL</th>
                                    <th>Fund AUM</th>
<!--                                    <th>Strategy AUM</th>-->
                                    <th>Manager AUM</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let fund of selectedArchivedResult?.top50qualifiedFunds; let i = index">
                                    <td>{{i + 1}}</td>
                                    <td>{{fund.fundId}}</td>
                                    <td>{{(fund.added ? '* ' : '') + fund.fundName}}</td>
                                    <td>{{fund.investmentManager}}</td>
                                    <td>{{fund.mainStrategy}}</td>
                                    <td>{{fund.annualizedReturn | number:'1.2-2'}}</td>
                                    <td>{{fund.sortino | number:'1.2-2' }}</td>
                                    <td>{{(fund.beta | number:'1.1-1') == 0.0 ? (fund.beta > 0 ? 0.1 : -0.1) : (fund.beta | number:'1.1-1')}}</td>
                                    <td>{{fund.cfVar| number:'1.2-2'}}</td>
                                    <td>{{fund.alpha| number:'1.2-2'}}</td>
                                    <td>{{fund.omega| number:'1.2-2'}}</td>
                                    <td style="background-color: #f9eaea;">{{fund.totalScore| number:'1.2-2'}}</td>
                                    <td>{{getAmountShort(fund.fundAUM)}}</td>
<!--                                    <td>{{getAmountShort(fund.strategyAUM)}}</td>-->
                                    <td>{{getAmountShort(fund.managerAUM)}}</td>
                                </tr>
                                <tr>
                                    <td colspan="4">* - manually added fund</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>


                <div class="row withpadding top-buffer">
                    <span style="font-weight: bold;">Other Qualified funds:</span>
                    <button [disabled]="selectedArchivedResult?.qualifiedFunds == null || selectedArchivedResult?.qualifiedFunds.length == 0"
                            class="btn btn-sm btn-success" type="button" data-toggle="collapse"
                            data-target="#archivedFinalQualifiedFundListCollapse" aria-expanded="false">
                            <span>{{selectedArchivedResult?.qualifiedFunds != null ? (selectedArchivedResult?.qualifiedFunds.length - selectedArchivedResult?.top50qualifiedFunds.length) : 0}}
                            ({{selectedArchivedResult?.qualifiedFunds != null ? selectedArchivedResult?.qualifiedFunds.length : 0}})</span>
                    </button>
                    <div class="collapse" id="archivedFinalQualifiedFundListCollapse">
                        <div class="card card-body">
                            <table class="table table-responsive table-hover condensed-table small">
                                <thead>
                                <tr>
                                    <th >#</th>
                                    <th>Fund ID</th>
                                    <th>Fund name</th>
                                    <th>Investment Manager</th>
                                    <th>Main Strategy</th>
                                    <th>Ann RoR</th>
                                    <th>Sortino</th>
                                    <th>Beta</th>
                                    <th>CF Var 99</th>
                                    <th>Alpha</th>
                                    <th>Omega</th>
                                    <th>TOTAL</th>
                                    <th>Fund AUM</th>
<!--                                    <th>Strategy AUM</th>-->
                                    <th>Manager AUM</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let fund of selectedArchivedResult?.qualifiedFunds | slice:selectedArchivedResult?.top50qualifiedFunds.length ; let i = index">

                                    <td>{{i + selectedArchivedResult?.top50qualifiedFunds.length + 1}}</td>
                                    <td>{{fund.fundId}}</td>
                                    <td>{{fund.fundName}}</td>
                                    <td>{{fund.investmentManager}}</td>
                                    <td>{{fund.mainStrategy}}</td>
                                    <td>{{fund.annualizedReturn | number:'1.2-2'}}</td>
                                    <td>{{fund.sortino | number:'1.2-2' }}</td>
                                    <td>{{(fund.beta | number:'1.1-1') == 0.0 ? (fund.beta > 0 ? 0.1 : -0.1) : (fund.beta | number:'1.1-1')}}</td>
                                    <td>{{fund.cfVar| number:'1.2-2'}}</td>
                                    <td>{{fund.alpha| number:'1.2-2'}}</td>
                                    <td>{{fund.omega| number:'1.2-2'}}</td>
                                    <td style="background-color: #f9eaea">{{fund.totalScore| number:'1.2-2'}}</td>
                                    <td>{{getAmountShort(fund.fundAUM)}}</td>
<!--                                    <td>{{getAmountShort(fund.strategyAUM)}}</td>-->
                                    <td>{{getAmountShort(fund.managerAUM)}}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row withpadding top-buffer">
                    <span style="font-weight: bold;">Unqualified funds:</span>
                    <button [disabled]="selectedArchivedResult?.unqualifiedFunds == null || selectedArchivedResult?.unqualifiedFunds.length == 0"
                            class="btn btn-sm btn-danger" type="button" data-toggle="collapse"
                            data-target="#archivedFinalUnqualifiedFundListCollapse" aria-expanded="false" aria-controls="archivedFinalUnqualifiedFundListCollapse">
                            <span>{{selectedArchivedResult?.unqualifiedFunds != null ?
                                selectedArchivedResult?.unqualifiedFunds.length : 0}}</span>
                    </button>
                    <div class="collapse" id="archivedFinalUnqualifiedFundListCollapse">
                        <div class="card card-body">
                            <table class="table table-responsive table-hover condensed-table small">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Fund ID</th>
                                    <th>Fund name</th>
                                    <th>Investment Manager</th>
                                    <th>Main Strategy</th>
                                    <th>Fund AUM</th>
<!--                                    <th>Strategy AUM</th>-->
                                    <th>Manager AUM</th>
                                    <th>Track record</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let fund of selectedArchivedResult?.unqualifiedFunds; let i = index">
                                    <td>{{i + 1}}</td>
                                    <td>{{fund.fundId}}</td>
                                    <td>{{fund.fundName}}</td>
                                    <td>{{fund.investmentManager}}</td>
                                    <td>{{fund.mainStrategy}}</td>
                                    <td>
                                        <!--                                            {{getAmountShort(fund.fundAUM)}}-->
                                        <span *ngIf="fund.fundAUM != null" [style.text-decoration]="fund.editedFundAUM != null ? 'line-through' : ''" data-toggle="tooltip"
                                              data-placement="top" title="{{fund.fundAUM}}">
                                            ${{getAmountShort(fund.fundAUM)}}
                                            <span class="glyphicon glyphicon-calendar"
                                                  *ngIf="fund?.fundAUMDate != null"
                                                  data-toggle="tooltip" data-placement="top" title="{{fund.fundAUMDate}}">
                                            </span>
                                            </span>
                                        <span *ngIf="fund.editedFundAUM != null" data-placement="top" [style.border]="'1px solid black'" title="{{fund.editedFundAUM}}" >
                                                ${{getAmountShort(fund.editedFundAUM)}}
                                                <span class="glyphicon glyphicon-calendar"
                                                      *ngIf="fund?.editedFundAUMDate != null"
                                                      data-toggle="tooltip" data-placement="top" title="{{fund.editedFundAUMDate}}">
                                                </span>
                                            </span>
                                        <span *ngIf="fund.fundAUM == null && fund.recentFundAUM != null">
                                                $ {{getAmountShort(fund.recentFundAUM)}} {{(fund.recentFundAUMDate != null ? "(" + getReportDateShortFormatted(fund.recentFundAUMDate) + ")" : '')}}
                                            </span>

                                        <span *ngIf="fund.currency != null && fund.currency.code != null && fund.currency.code != 'USD'"> <!--[style.color]="fundAUMByCurrency != null ? 'black' : 'red'">-->
                                            {{fund.currency.code + ' ' + getAmountShort(fund.fundAUMByCurrency)}}
                                            </span>
                                        <span class="glyphicon glyphicon-calendar"
                                              *ngIf="fund?.fundAUMDate != null && fund.fundAUM == null"
                                              data-toggle="tooltip" data-placement="top" title="{{fund.fundAUMDate}}">
                                            </span>
                                    </td>
<!--                                    <td>-->
<!--                                        &lt;!&ndash;                                            {{getAmountShort(fund.strategyAUM)}}&ndash;&gt;-->
<!--                                        <span style="color:green" *ngIf="fund.fundAUMCheck" class="glyphicon glyphicon-ok"></span>-->
<!--                                        <span style="color:red" *ngIf="!fund.fundAUMCheck" class="glyphicon glyphicon-remove"></span>-->
<!--                                        &nbsp;&nbsp;-->
<!--                                        <span *ngIf="fund?.strategyAUM != null">-->
<!--                                                {{getAmountShort(fund.strategyAUM)}}-->
<!--                                            </span>-->
<!--                                        <span *ngIf="fund.strategyAUM == null && fund.recentStrategyAUM != null">-->
<!--                                                {{getAmountShort(fund.recentStrategyAUM)}} {{fund.recentStrategyAUMDate != null ? getReportDateShortFormatted(fund.recentStrategyAUMDate) : ''}}-->
<!--                                            </span>-->
<!--                                        <span class="glyphicon glyphicon-exclamation-sign"-->
<!--                                              *ngIf="fund.strategyAUMWithMissingCurrency"-->
<!--                                              data-toggle="tooltip" data-placement="top" title="Currency rates missing for some of the Manager funds">-->
<!--                                            </span>-->
<!--                                    </td>-->
                                    <td>
                                        <!--                                            {{getAmountShort(fund.managerAUM)}}-->
                                        <span style="color:green" *ngIf="fund.managerAUMCheck" class="glyphicon glyphicon-ok"></span>
                                        <span style="color:red" *ngIf="!fund.managerAUMCheck" class="glyphicon glyphicon-remove"></span>
                                        &nbsp;&nbsp;
                                        {{fund.managerAUM != null ? getAmountShort(fund.managerAUM) : 'N/A'}} &nbsp;
                                    </td>
                                    <td>
                                        <span style="color:green" *ngIf="fund.trackRecordCheck" class="glyphicon glyphicon-ok"></span>
                                        <span style="color:red" *ngIf="!fund.trackRecordCheck" class="glyphicon glyphicon-remove"></span>
                                        {{getReportDateShortFormatted(fund.recentTrackRecordDate) }}
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row withpadding top-buffer">
                    <span style="font-weight: bold;">Undecided funds:</span>

                    <button [disabled]="selectedArchivedResult?.undecidedFunds == null || selectedArchivedResult?.undecidedFunds.length == 0"
                            class="btn btn-sm btn-secondary" type="button" data-toggle="collapse"
                            data-target="#archivedFinalUndecidedFundListCollapse" aria-expanded="false" aria-controls="archivedFinalUndecidedFundListCollapse">
                            <span>{{selectedArchivedResult?.undecidedFunds != null ?
                                selectedArchivedResult?.undecidedFunds.length : 0}}</span>
                    </button>

                    <div class="collapse" id="archivedFinalUndecidedFundListCollapse">
                        <div class="card card-body">
                            <table class="table table-responsive table-hover condensed-table small">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Fund ID</th>
                                    <th>Fund name</th>
                                    <th>Investment Manager</th>
                                    <th>Main Strategy</th>
                                    <th>Fund AUM</th>
<!--                                    <th>Strategy AUM</th>-->
                                    <th>Manager AUM</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let fund of selectedArchivedResult?.undecidedFunds; let i = index">
                                    <td>{{i + 1}}</td>
                                    <td>{{fund.fundId}}</td>
                                    <td>{{fund.fundName}}</td>
                                    <td>{{fund.investmentManager}}</td>
                                    <td>{{fund.mainStrategy}}</td>
                                    <td>{{getAmountShort(fund.fundAUM)}}</td>
<!--                                    <td>{{getAmountShort(fund.strategyAUM)}}</td>-->
                                    <td>{{getAmountShort(fund.managerAUM)}}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <hr style="height:2px;border:none;color:#ccc;background-color:#ccc;">

                <h4>OTHER DATA </h4>
                <div class="row withpadding top-buffer">
                    <span style="font-weight: bold;">Edited funds:</span>
                    <button [disabled]="selectedArchivedResult?.editedFunds == null || selectedArchivedResult?.editedFunds.length == 0"
                            class="btn btn-sm btn-success" type="button" data-toggle="collapse"
                            data-target="#archivedEditedFundListCollapse" aria-expanded="false">
                            <span>{{selectedArchivedResult?.editedFunds != null ?
                                selectedArchivedResult?.editedFunds.length : 0}}</span>
                    </button>
                    <div class="collapse" id="archivedEditedFundListCollapse">
                        <div class="card card-body">
                            <table class="table table-responsive table-hover condensed-table small">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Fund ID</th>
                                    <th>Fund name</th>
                                    <th>Investment Manager</th>
                                    <th>Main Strategy</th>
                                    <!--                                    <th>Ann RoR</th>-->
                                    <!--                                    <th>Sortino</th>-->
                                    <!--                                    <th>Beta</th>-->
                                    <!--                                    <th>CF Var 99</th>-->
                                    <!--                                    <th>Alpha</th>-->
                                    <!--                                    <th>Omega</th>-->
                                    <!--                                    <th>TOTAL</th>-->
                                    <th>Fund AUM</th>
                                    <!--                                    <th>Strategy AUM</th>-->
                                    <th>Manager AUM</th>
                                    <th>Comment</th>
                                    <th>&nbsp;</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let fund of selectedArchivedResult?.editedFunds; let i = index">
                                    <td>{{i + 1}}</td>
                                    <td>{{fund.fundId}}</td>
                                    <td><span [style.text-decoration]="fund.excluded ? 'line-through' : ''">{{fund.fundName}}</span></td>
                                    <td>{{fund.investmentManager}}</td>
                                    <td>{{fund.mainStrategy}}</td>
                                    <!--                                    <td>{{fund.annualizedReturn | percent:'1.2-2'}}</td>-->
                                    <!--                                    <td>{{fund.sortino | number:'1.2-2' }}</td>-->
                                    <!--                                    <td>{{(fund.beta | number:'1.1-1') == 0.0 ? (fund.beta > 0 ? 0.1 : -0.1) : (fund.beta | number:'1.1-1')}}</td>-->
                                    <!--                                    <td>{{fund.cfVar| percent:'1.2-2'}}</td>-->
                                    <!--                                    <td>{{fund.alpha| percent:'1.2-2'}}</td>-->
                                    <!--                                    <td>{{fund.omega| number:'1.2-2'}}</td>-->
                                    <!--                                    <td style="background-color: #f9eaea;">{{fund.totalScore| number:'1.2-2'}}</td>-->
                                    <td>{{getAmountShort(fund.editedFundAUM)}}</td>
                                    <!--                                    <td>{{getAmountShort(fund.strategyAUM)}}</td>-->
                                    <td>{{getAmountShort(fund.managerAUM)}}</td>
                                    <td>{{fund.editedFundAUMComment}}</td>
                                    <td>{{fund.excluded? 'EXCLUDED' : ''}}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row withpadding top-buffer">
                    <span style="font-weight: bold;">Benchmarks:</span>
                    <button [disabled]="selectedArchivedResult?.benchmarks == null || selectedArchivedResult?.benchmarks.length == 0"
                            class="btn btn-sm btn-success" type="button" data-toggle="collapse"
                            data-target="#archivedBenchmarksListCollapse" aria-expanded="false">
                            <span>{{selectedArchivedResult?.benchmarks != null ?
                                selectedArchivedResult?.benchmarks.length : 0}}</span>
                    </button>
                    <div class="collapse" id="archivedBenchmarksListCollapse">
                        <div class="card card-body">
                            <table class="table table-responsive table-hover condensed-table small">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Benchmark</th>
                                    <th>Date</th>
                                    <th>Return Value</th>
                                    <th>YTD</th>
                                    <th>&nbsp;</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let benchmark of selectedArchivedResult?.benchmarks; let i = index">
                                    <td>{{i + 1}}</td>
                                    <td>{{benchmark?.benchmark?.nameEn}}</td>
                                    <td>{{benchmark.date}}</td>
                                    <td>{{benchmark.calculatedMonthReturn}}</td>
                                    <td>{{benchmark.ytd}}</td>
                                    <td>&nbsp;</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row withpadding top-buffer">
                    <span style="font-weight: bold;">Currency Rates:</span>
                    <button [disabled]="selectedArchivedResult?.currencyRates == null || selectedArchivedResult?.currencyRates.length == 0"
                            class="btn btn-sm btn-success" type="button" data-toggle="collapse"
                            data-target="#archivedCurrencyRatesListCollapse" aria-expanded="false">
                            <span>{{selectedArchivedResult?.currencyRates != null ?
                                selectedArchivedResult?.currencyRates.length : 0}}</span>
                    </button>
                    <div class="collapse" id="archivedCurrencyRatesListCollapse">
                        <div class="card card-body">
                            <table class="table table-responsive table-hover condensed-table small">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Currency</th>
                                    <th>Date</th>
                                    <th>Value USD</th>
                                    <th>Value KZT</th>
                                    <th>Avg Month Value</th>
                                    <th>Ag Year Value</th>
                                    <th>&nbsp;</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let currencyRate of selectedArchivedResult?.currencyRates; let i = index">
                                    <td>{{i + 1}}</td>
                                    <td>{{currencyRate?.currency?.nameEn}}</td>
                                    <td>{{currencyRate.date}}</td>
                                    <td>{{currencyRate.valueUSD}}</td>
                                    <td>{{currencyRate.value}}</td>
                                    <td>{{currencyRate.averageValue}}</td>
                                    <td>{{currencyRate.averageValueYear}}</td>
                                    <td>&nbsp;</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="fundListModal" role="dialog" tabindex="-1">
        <div class="modal-dialog" style=" min-height: 100px; max-height:85%;  margin-top: 100px; margin-bottom:50px; width:75%;">
            <div class="modal-content" id="modalMessagesDiv">
                <div [ngBusy]="busyModal"  class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="alert alert-danger" *ngIf="modalErrorMessage != null"><span>{{modalErrorMessage}}</span>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="alert alert-info" *ngIf="modalSuccessMessage != null"><span>{{modalSuccessMessage}}</span>
                            </div>
                        </div>
                    </div>
                    <div class="row withpadding" *ngIf="fundListType == 1 || fundListType == 2">
                        <button *ngIf="isAlternative" class="btn btn-primary pull-left" (click)="exportFundList()">Export as XLSX</button>
                        <button *ngIf="!isAlternative" class="btn btn-primary pull-left" (click)="exportFundList()">Export as XLSX</button>
                        <span class="pull-right">&nbsp;</span>
                    </div>
                    <div class="row">&nbsp;</div>
                    <div class="row withpadding" *ngIf="fundListType == 1">
                        <button class="btn btn-success pull-right"  [disabled]="filteredResult?.filteredResultStatistics?.finalResults != null"
                                (click)="saveScoringResults(fundListLookbackAUM, fundListLookbackReturn)">Mark as final</button>
                        <span class="pull-right">&nbsp;</span>
                    </div>
                    <div class="row withpadding">
                        <div *ngIf="filteredFundList != null">
                            <br/>
                            <span style="font-weight: bold">AUM Lookback: {{fundListLookbackAUM}}</span>
                            <br/>
                            <span style="font-weight: bold">RETURN Lookback: {{fundListLookbackReturn}}</span>
                            <br/>
                            <span style="font-weight: bold">TOTAL: {{filteredFundList.length}}</span>
                            <br/>
                            <br/>
                            <br/>
                            <i>* - added funds</i>
                            <br/>
                            <i><span style="border: 1px solid black">&nbsp;&nbsp;&nbsp;</span> - edited fund AUM</i>
                            <br/>
                            <table class="table table-hover small">
                                <thead>
                                <tr>
                                    <!--<th>&nbsp;</th>-->
                                    <th>#</th>
                                    <th>FUND ID</th>
                                    <th>FUND NAME</th>
                                    <th>INVESTMENT MANAGER</th>
                                    <th>MAIN STRATEGY</th>
<!--                                    <th *ngIf="fundListType == 2">Strategy AUM Check</th>-->
<!--                                    <th *ngIf="fundListType == 2">Manager AUM Check</th>-->
<!--                                    <th *ngIf="fundListType == 2">Track Record Check</th>-->
                                    <th *ngIf="fundListType == 1">Ann RoR</th>
                                    <th *ngIf="fundListType == 1">Sortino</th>
                                    <th *ngIf="fundListType == 1">Beta</th>
                                    <th *ngIf="fundListType == 1">CF Var 99</th>
                                    <th *ngIf="fundListType == 1">Alpha</th>
                                    <th *ngIf="fundListType == 1">Omega</th>
                                    <th  *ngIf="fundListType == 1" style="background-color: #f9eaea">Total</th>
                                    <th colspan="2">FUND AUM</th>
                                    <!--<th>CURRENCY/AUM</th>-->
<!--                                    <th>STRATEGY AUM,$</th>-->
                                    <th>MANAGER AUM,$</th>
                                    <th *ngIf="isUnqualifiedFundList">TRACK RECORD</th>
                                    <th>&nbsp;</th>
                                    <th>&nbsp;</th>
                                    <!--<th *ngIf="showParameterMatching">FUND AUM</th>-->
                                    <!--<th *ngIf="showParameterMatching">MANAGER AUM</th>-->
                                    <!--<th *ngIf="showParameterMatching">TRACK RECORD</th>-->
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor = "let fund of filteredFundList; let i=index" id="{{fund.fundId}}">
                                    <td>{{i + 1}}</td>
                                    <td>{{fund.fundId}}</td>
                                    <td><span [style.text-decoration]="fund.excluded ? 'line-through' : ''">{{fund.fundName}}</span> <span *ngIf="fund.added">*</span></td>
                                    <td>{{fund.investmentManager}}</td>
                                    <td>{{fund.mainStrategy}}</td>
<!--                                    <td *ngIf="fundListType == 2">-->
<!--                                        <span style="color:green" *ngIf="fund.strategyAUMCheck" class="glyphicon glyphicon-ok"></span>-->
<!--                                        <span style="color:red" *ngIf="!fund.strategyAUMCheck" class="glyphicon glyphicon-remove"></span>-->
<!--                                    </td>-->
<!--                                    <td *ngIf="fundListType == 2">-->
<!--                                        <span style="color:green"  *ngIf="fund.managerAUMCheck" class="glyphicon glyphicon-ok"></span>-->
<!--                                        <span style="color:red" *ngIf="!fund.managerAUMCheck" class="glyphicon glyphicon-remove"></span>-->
<!--                                    </td>-->
<!--                                    <td *ngIf="fundListType == 2">-->
<!--                                        <span style="color:green"  *ngIf="fund.trackRecordCheck" class="glyphicon glyphicon-ok"></span>-->
<!--                                        <span style="color:red" *ngIf="!fund.trackRecordCheck" class="glyphicon glyphicon-remove"></span>-->
<!--                                    </td>-->
                                    <td *ngIf="fundListType == 1">{{fund.annualizedReturn | number:'1.2-2'}}</td>
                                    <td *ngIf="fundListType == 1">{{fund.sortino | number:'1.2-2' }}</td>
                                    <td *ngIf="fundListType == 1">{{(fund.beta | number:'1.1-1') == 0.0 ? (fund.beta > 0 ? 0.1 : -0.1) : (fund.beta | number:'1.1-1')}}</td>
                                    <td *ngIf="fundListType == 1">{{fund.cfVar| number:'1.2-2'}}</td>
                                    <td *ngIf="fundListType == 1">{{fund.alpha| number:'1.2-2'}}</td>
                                    <td *ngIf="fundListType == 1">{{fund.omega| number:'1.2-2'}}</td>
                                    <td  *ngIf="fundListType == 1" style="background-color: #f9eaea">{{fund.totalScore| number:'1.2-2'}}</td>
                                    <td align="center">
<!--                                        <span style="color:green" *ngIf="fund.strategyAUMCheck" class="glyphicon glyphicon-ok"></span>-->
<!--                                        <span style="color:red" *ngIf="!fund.strategyAUMCheck" class="glyphicon glyphicon-remove"></span>-->
                                        <br/>
                                        <span *ngIf="fund.fundAUM != null" [style.text-decoration]="fund.editedFundAUM != null ? 'line-through' : ''" data-toggle="tooltip"
                                                     data-placement="top" title="{{fund.fundAUM}}">
                                            ${{getAmountShort(fund.fundAUM)}}
                                            <span class="glyphicon glyphicon-calendar"
                                                  *ngIf="fund?.fundAUMDate != null"
                                                  data-toggle="tooltip" data-placement="top" title="{{fund.fundAUMDate}}">
                                            </span>
                                        </span>
                                        <span *ngIf="fund.editedFundAUM != null" data-placement="top" [style.border]="'1px solid black'" title="{{fund.editedFundAUM}}" >
                                            ${{getAmountShort(fund.editedFundAUM)}}
                                            <span class="glyphicon glyphicon-calendar"
                                                  *ngIf="fund?.editedFundAUMDate != null"
                                                  data-toggle="tooltip" data-placement="top" title="{{fund.editedFundAUMDate}}">
                                            </span>
                                        </span>
                                        <span *ngIf="fund.fundAUM == null && fund.recentFundAUM != null">
                                            $ {{getAmountShort(fund.recentFundAUM)}} {{(fund.recentFundAUMDate != null ? "(" + getReportDateShortFormatted(fund.recentFundAUMDate) + ")" : '')}}
                                        </span>
                                        <!--<span *ngIf="fund.fundAUM == null && fund.recentFundAUM == null" style="color:red">-</span>-->
                                    </td>
                                    <td>
                                        <span *ngIf="fund.currency != null && fund.currency != 'USD'"> <!--[style.color]="fundAUMByCurrency != null ? 'black' : 'red'">-->
                                            {{fund.currency + ' ' + getAmountShort(fund.fundAUMByCurrency)}}
                                        </span>
                                        <span class="glyphicon glyphicon-calendar"
                                              *ngIf="fund?.fundAUMDate != null && fund.fundAUM == null"
                                              data-toggle="tooltip" data-placement="top" title="{{fund.fundAUMDate}}">
                                        </span>

                                        <a *ngIf="fund.currency != null && fund.currency != 'USD' && fund.fundAUM == null && fund.fundAUMByCurrency != null"
                                           target="_blank" [routerLink]="['/lookups/currency/', {params: getNewCurrencyRateParams(fund)}]">
                                            <span class="glyphicon glyphicon-plus-sign"></span>
                                        </a>
                                    </td>
<!--                                    <td align="center">-->
<!--                                        &lt;!&ndash;<div *ngIf="fund?.differentManagerCurrencies == null || !fund?.differentManagerCurrencies">&ndash;&gt;-->
<!--                                        <span style="color:green" *ngIf="fund.fundAUMCheck" class="glyphicon glyphicon-ok"></span>-->
<!--                                        <span style="color:red" *ngIf="!fund.fundAUMCheck" class="glyphicon glyphicon-remove"></span>-->
<!--                                        &nbsp;&nbsp;-->
<!--                                            <span *ngIf="fund?.strategyAUM != null">-->
<!--                                                {{getAmountShort(fund.strategyAUM)}}-->
<!--                                            </span>-->
<!--                                            <span *ngIf="fund.strategyAUM == null && fund.recentStrategyAUM != null">-->
<!--                                                {{getAmountShort(fund.recentStrategyAUM)}} {{fund.recentStrategyAUMDate != null ? getReportDateShortFormatted(fund.recentStrategyAUMDate) : ''}}-->
<!--                                            </span>-->
<!--                                            <span class="glyphicon glyphicon-exclamation-sign"-->
<!--                                                  *ngIf="fund.strategyAUMWithMissingCurrency"-->
<!--                                                  data-toggle="tooltip" data-placement="top" title="Currency rates missing for some of the Manager funds">-->
<!--                                            </span>-->
<!--                                            &lt;!&ndash;<a data-toggle="modal" data-target="#infoModal" style="cursor: pointer">&ndash;&gt;-->
<!--                                                &lt;!&ndash;<span class="glyphicon glyphicon-exclamation-sign"></span>&ndash;&gt;-->
<!--                                            &lt;!&ndash;</a>&ndash;&gt;-->
<!--                                        &lt;!&ndash;</div>&ndash;&gt;-->
<!--                                        &lt;!&ndash;<div *ngIf="fund?.differentManagerCurrencies">&ndash;&gt;-->
<!--                                            &lt;!&ndash;<span style="color: red">Different currency funds for manager</span>&ndash;&gt;-->
<!--                                        &lt;!&ndash;</div>&ndash;&gt;-->
<!--                                    </td>-->
                                    <td *ngIf="!fund.editing">
                                        <span style="color:green" *ngIf="fund.managerAUMCheck" class="glyphicon glyphicon-ok"></span>
                                        <span style="color:red" *ngIf="!fund.managerAUMCheck" class="glyphicon glyphicon-remove"></span>
                                        &nbsp;&nbsp;
                                        {{fund.managerAUM != null ? getAmountShort(fund.managerAUM) : 'N/A'}} &nbsp;
                                        <!--<span (click)="editFundManagerAUM(fund)" style="color: black">-->
                                            <!--<span class="glyphicon glyphicon-pencil"></span>-->
                                        <!--</span>-->
                                    </td>
                                    <td *ngIf="fund.editing">
                                        <!--<div class="input-group">-->
                                            <!--<input class="form-control small"  type="text" name="managerAUM" [(ngModel)]="fund.managerAUM" (keyup)="onNumberFund(fund)"/>-->
                                            <!--<span class="input-group-btn">-->
                                                <!--<button class="btn-xs btn-success inline-block" (click)="saveManagerAUM(fund)"><span class="small glyphicon glyphicon-ok"></span></button>-->
                                                <!--<button class="btn-xs btn-default inline-block" (click)="cancelManagerAUMUpdate(fund)"><span class="small glyphicon glyphicon-ban-circle"></span></button>-->
                                            <!--</span>-->
                                        <!--</div>-->
                                    </td>
                                    <td *ngIf="isUnqualifiedFundList">
                                        <span style="color:green" *ngIf="fund.trackRecordCheck" class="glyphicon glyphicon-ok"></span>
                                        <span style="color:red" *ngIf="!fund.trackRecordCheck" class="glyphicon glyphicon-remove"></span>
                                        {{getReportDateShortFormatted(fund.recentTrackRecordDate) }}
                                    </td>

                                <td>
                                    <!--<a class="btn btn-xs btn-default" data-toggle="modal" (click)="editFund(fund)" data-target="#insideModal">edit</a>-->

                                    <span *ngIf="filteredResult.editable" (click)="editFund(fund)" style="color: black" data-toggle="modal" data-target="#fundEditModal">
                                            <span class="glyphicon glyphicon-pencil"></span>
                                    </span>
                                </td>
                                <td>
                                    <span *ngIf="filteredResult.editable" style="color: black" data-toggle="modal" (click)="openExcludeFund(fund, 'FUNDLIST')" data-target="#excludeFundModal">
                                            <span class="glyphicon glyphicon-trash"></span>
                                    </span>
                                </td>
<!--                                    <td *ngIf="showParameterMatching" style="background-color: #2e6da4">+</td>
                                    <td *ngIf="showParameterMatching" style="background-color: #2e6da4">+</td>
                                    <td *ngIf="showParameterMatching" style="background-color: #2e6da4">-</td>-->
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" style="display:none;" class="btn btn-default pull-left" id="closeFundListModalButton" (click)="closeFundListModal()" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="excludeFundModal" role="dialog" tabindex="-1">
        <div class="modal-dialog" style=" min-height: 100px; max-height:85%;  margin-top: 100px; margin-bottom:50px; width:75%;">
            <div class="modal-content"  *ngIf="selectedFund != null">
                <div [ngBusy]="busyModal"  class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="alert alert-danger" *ngIf="excludeFundModalErrorMessage != null"><span>{{excludeFundModalErrorMessage}}</span>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="alert alert-info" *ngIf="excludeFundModalSuccessMessage != null"><span>{{excludeFundModalSuccessMessage}}</span>
                            </div>
                        </div>
                    </div>
                    <div class="row withpadding">
                        <h3>Excluding fund</h3>
                    </div>

                    <div class="row withpadding">
                        <div class="col-md=10">{{selectedFund.fundName}}</div>
                    </div>
                    <br/>
                    <br/>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="col-md-2">
                                <label>Comment</label>
                            </div>
                            <div class="col-md-10">
                                <input class="col-md-10 form-control" placeholder="Comment..." [(ngModel)]="selectedFund.excludeComment">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="col-md-2">
                                &nbsp;
                            </div>
                            <div class="col-md-10">
                                <input id="excludeFromStrategyAUM" class="form-check-input" type="checkbox" [(ngModel)]="selectedFund.excludeFromStrategyAUM">
                                <label class="form-check-label" for="excludeFromStrategyAUM">Exclude from Strategy AUM</label>
                            </div>
                        </div>
                    </div>
                    <br/>
                    <div class="row withpadding">
                        <button class="btn btn-success pull-right"(click)="excludeFund()">Exclude</button>
                    </div>
                    <br/>
                    <div class="row withpadding">
                        <button class="btn btn-default pull-left" id="closeFundExcludeModalBtn" (click)="closeFundExcludeModal()" data-dismiss="modal">CLOSE</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="fundEditModal" role="dialog" tabindex="-1">
        <!--<div class="modal-dialog" style="overflow-y: scroll; min-height: 100px; margin-top: 20%; width:75%;">-->
        <div class="modal-dialog" style=" min-height: 100px; max-height:85%;  margin-top: 100px; margin-bottom:50px; width:75%;">
            <div class="modal-content" *ngIf="selectedFund != null">
                <div [ngBusy]="busyFundEdit"  class="modal-body">
                    <div class="row">
                        <div class="row top-buffer" >
                            <div class="col-md-12">
                                <div class="alert alert-info" *ngIf="selectedFundSuccessMessage != null"><span>{{selectedFundSuccessMessage}}</span>
                                </div>
                            </div>
                        </div>
                        <div class="row top-buffer" >
                            <div class="col-md-12">
                                <div class="alert alert-danger" *ngIf="selectedFundErrorMessage != null"><span>{{selectedFundErrorMessage}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <table class="table table-hover small">
                            <thead>
                            <tr>
                                <th width="10%">FUND ID</th>
                                <th width="20%">FUND NAME</th>
                                <th width="20%">INVESTMENT MANAGER</th>
<!--                                <th width="20%">MAIN STRATEGY</th>-->
                                <th width="20%">FUND STATUS</th>
                                <th width="15%">FUND AUM</th>
                                <th width="15%">MANAGER AUM,$</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td><input [readonly]="true" class="form-control small"  type="text" name="fundId" [(ngModel)]="selectedFund.fundId"/></td>
                                <td><input [readonly]="!selectedFund.added" class="form-control small" required type="text" name="fundName" [(ngModel)]="selectedFund.fundName"/></td>
                                <td><input [readonly]="!selectedFund.added" class="form-control small" required type="text" name="investmentManager" [(ngModel)]="selectedFund.investmentManager"/></td>
<!--                                <td><input [readonly]="!selectedFund.added" class="form-control small"  type="text" name="mainStrategy" [(ngModel)]="selectedFund.mainStrategy"/></td>-->
                                <td><input [readonly]="!selectedFund.added" class="form-control small"  type="text" name="fundStatus" [(ngModel)]="selectedFund.fundStatus"/></td>
                                <td>
                                    <input [readonly]="!selectedFund.added" class="form-control"  required type="text" name="fundAUM" [(ngModel)]="selectedFund.fundAUM"
                                           [style.text-decoration]="selectedFund.editedFundAUM != null && selectedFund.editedFundAUM != '' ? 'line-through' : ''"
                                           (keyup)="onNumberChangeSelectedFundAUM()"/>
                                    {{selectedFund.currency}}
                                </td>
                                <td>
                                    <input class="form-control"  type="text" name="fundAUM" [(ngModel)]="selectedFund.managerAUM"
                                           (keyup)="onNumberChangeSelectedFundManagerAUM()"/>
                                </td>
                            </tr>
<!--                            <tr>-->
<!--                                <td colspan="2" style="text-align:right;">-->
<!--                                    <span>Comment (actual AUM, or combined strategy AUM etc)</span>-->
<!--                                </td>-->
<!--                                <td colspan="4">-->
<!--                                    <input class="form-control"  type="text" name="fundAUMComment" [(ngModel)]="selectedFund.fundAUMComment" />-->
<!--                                </td>-->
<!--                            </tr>-->
                            </tbody>
                        </table>
                        <br/>
                        <table class="table table-hover small" *ngIf="!selectedFund.added">
                            <thead>
                            <tr>
                                <th width="10%">&nbsp;</th>
                                <th width="60%">DESCRIPTION</th>
                                <th width="15%">FUND AUM DATE</th>
                                <th width="15%">FUND AUM, $</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>UPDATE FUND AUM</td>
                                <td><input [style.text-decoration]="selectedFund.editedFundAUM == null || selectedFund.editedFundAUM === '' ? 'line-through' : ''"
                                           [readonly]="selectedFund.added"
                                           [required]="selectedFund.editedFundAUM != null && selectedFund.editedFundAUM != ''"
                                           class="form-control small" type="text" name="editedFundAUMComment" [(ngModel)]="selectedFund.editedFundAUMComment"/></td>
                                <td>
                                    <div class='input-group date col-md-2' id='editedFundAUMDateTimePicker' style="width: 100%">
                                        <input [readonly]="selectedFund.added" [required]="selectedFund.editedFundAUM != null && selectedFund.editedFundAUM != ''" type='text' class="form-control" id="editedFundAUMDate" name="editedFundAUMDate" [(ngModel)]="selectedFund.editedFundAUMDateMonthYear"
                                               [style.text-decoration]="selectedFund.editedFundAUM == null || selectedFund.editedFundAUM === '' ? 'line-through' : ''"/>
                                                <span class="input-group-addon">
                                                    <span class="glyphicon glyphicon-calendar"></span>
                                                </span>
                                    </div>
                                </td>
                                <td><input [readonly]="selectedFund.added"
                                           class="form-control small" type="text" name="editedFundAUM" [(ngModel)]="selectedFund.editedFundAUM"
                                           (keyup)="onNumberChangeSelectedEditedFundAUM()"/></td>
                            </tr>
                            </tbody>
                        </table>
                        <div *ngIf="selectedFund.added">
                            <div class="row">
                                <h5 class="withpadding">TRACK RECORD</h5>
                                <br/>
                                <div class="col-md-12">
                                    <div class="col-md-2">
                                        <div class='input-group date col-md-2' style="width: 100%">
                                            <input type='text' class="form-control" readonly="true" [(ngModel)]="filteredResult.startDateMonth"/>
                                                    <span class="input-group-addon">
                                                        <span class="glyphicon glyphicon-calendar"></span>
                                                    </span>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        LOOKBACK = {{filteredResult.lookbackReturns}}
                                    </div>

                                    <div class="col-md-6">&nbsp;</div>
                                    <div class="col-md-2">
                                        <a class="btn btn-primary btn-sm pull-right" data-toggle="modal"
                                           data-target="#returnInputModal">copy returns
                                        </a>
                                    </div>
                                </div>
                            </div>

                            <br/>
                            <div class="row withpadding">
                                <table class="table smaller">
                                    <tr *ngFor="let datesByYear of selectedFundReturns; let i = index" [attr.data-index]="i">
                                        <td *ngFor="let dateOfYear of datesByYear; let j = index;" [attr.data-index]="j">
                                            <span style="font-weight: bold;">{{dateOfYear.date != null ? dateOfYear.date : ''}}</span>
                                            <input *ngIf="dateOfYear.date != null" [attr.id]="'input_' + i + '_' + j" class="form-control" [(ngModel)]="dateOfYear.value"/>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">&nbsp;</div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="col-md-9">
                                    <button class="btn btn-default pull-left" style="display:none;" id="closeFundEditModalBtn" (click)="closeFundEditModal()" data-dismiss="modal">CLOSE</button>
                                </div>
                                <div class="col-md-3">
                                    <button class="btn btn-success pull-right" (click)="saveFund()">SAVE</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="returnInputModal" role="dialog">
        <div class="modal-dialog" style="overflow-y: scroll; max-height:85%;  margin-top: 50px; margin-bottom:50px;">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <!--<h3 class="modal-title" >HEADER</h3>-->
                </div>
                <div class="modal-body">
                    <div class="alert alert-danger" *ngIf="returnUploadErrorMessage != null"><span>{{returnUploadErrorMessage}}</span></div>
                    <div class="alert alert-info" *ngIf="returnUploadSuccessMessage != null"><span>{{returnUploadSuccessMessage}}</span></div>
                    <br/>
                    <div>Format: <span style="font-weight: bold">date [tab] return</span></div>
                    <div>
                        Date format: <span style="font-weight: bold">dd.mm.yyyy</span>
                    </div>
                    <div>
                        Return format: <span style="font-weight: bold">xx.xx%</span>
                    </div>
                    <textarea class="form-control" placeholder="Paste returns here..."
                              name="uploadedReturns" [(ngModel)]="uploadedReturns"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-left" data-dismiss="modal" id="closeReturnsModalBtn" (click)='closeReturnsModal()'>Close</button>
                    <button type="button" class="btn btn-success pull-right" (click)="parseReturns()">Add</button>
                </div>
            </div>
        </div>
    </div>

</div>