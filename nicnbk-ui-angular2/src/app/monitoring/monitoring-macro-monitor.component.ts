import {Component, AfterViewInit, ViewChild} from "@angular/core";
import {ActivatedRoute} from "@angular/router";
import {CommonComponent} from "../common/common.component";
import {CommonTableau} from "./common-tableau.component";

import '../../../public/js/viz_v1.js';
import {GoogleChartComponent} from "../google-chart/google-chart.component";

declare var google:any;
declare var $: any;

@Component({
    selector: 'monitoring-macro-monitor',
    templateUrl: 'view/monitoring-macro-monitor.component.html',
    styleUrls: [],
    providers: [],
})
export class MonitoringMacroMonitorComponent extends GoogleChartComponent  {
    //ngAfterViewInit():void {
    //    this.tableau_func()
    //}

    constructor(
    ) {
        super();
    }

    drawGraph(){
        this.drawValuesTable();
        this.drawLineChart();
    }


    drawValuesTable(){
        var data = new google.visualization.DataTable();
        data.addColumn("string", "");
        this.setColumnData(data);
        this.setRowData(data);

        var options = {
            showRowNumber: false,
            width: '100%',
            height: '100%',
            'allowHtml': true,
            cssClassNames: {
                tableCell: '',
            }
        };

        var colorFormatter = new google.visualization.ColorFormat();
        colorFormatter.addRange(0, 1, 'white', '#9C0824');
        colorFormatter.addRange(1, 2, 'white', '#B41F27');
        colorFormatter.addRange(2, 3, 'white', '#CC312B');
        colorFormatter.addRange(3, 4, 'white', '#E86753');
        colorFormatter.addRange(4, 5, 'black', '#FCB4A5');
        colorFormatter.addRange(5, 6, 'black', '#B9D7B7');
        colorFormatter.addRange(6, 7, 'black', '#74AF72');
        colorFormatter.addRange(7, 8, 'white', '#428F4A');
        colorFormatter.addRange(8, 9, 'white', '#297839');
        colorFormatter.addRange(9, 10, 'white', '#09622A');
        for(var i = 1; i <= this.dates.length; i++){
            colorFormatter.format(data, i);
        }

        var chart = this.createTableChart(document.getElementById('table'));
        chart.draw(data, options);
    }

    private setColumnData(data){
        for(var i = 0; i < this.dates.length; i++){
            data.addColumn("number", this.dates[i]);
        }
    };

    private setRowData(data){
        data.addRows(this.data);
    }

    drawLineChart(){
        var data = new google.visualization.DataTable();
        data.addColumn("string", "Date");
        data.addColumn("number", "Macro Score");
        data.addColumn("number", "MSCI WORLD");

        data.addRows(this.getLineChartData());

        var options = {
            showRowNumber: false,
            width: '100%',
            height: '100%',
            'allowHtml': true,
            cssClassNames: {}
        };

        var chart = this.createLineChart(document.getElementById('line_chart'));
        chart.draw(data, options);
    }

    private getLineChartData(){
        var rows = [];
        for(var i = this.dates.length - 1; i >= 0; i--){
            var row = [this.dates[i], this.data[8][1+i], this.data[9][1+i]];
            rows.push(row);
        }
        //console.log(rows);
        return rows;
    }

    private dates = ["Nov-16", "Oct-16", "Sep-16","Aug-16", "Jul-16","Jun-16","May-16","Apr-16","Mar-16","Feb-16","Jan-16",
        "Dec-15","Nov-15", "Oct-15","Sep-15","Aug-15","Jul-15","Jun-15",
        "May-15",
        "Apr-15",
        "Mar-15",
        "Feb-15",
        "Jan-15",
        "Dec-14",
        "Nov-14",
        "Oct-14",
        "Sep-14",
        "Aug-14",
        "Jul-14",
        "Jun-14",
        "May-14",
        "Apr-14",
        "Mar-14",
        "Feb-14",
        "Jan-14",
        "Dec-13",
        "Nov-13",
        "Oct-13",
        "Sep-13",
        "Aug-13",
        "Jul-13",
        "Jun-13",
        "May-13",
        "Apr-13",
        "Mar-13",
        "Feb-13",
        "Jan-13",
        "Dec-12",
        "Nov-12",
        "Oct-12",
        "Sep-12",
        "Aug-12",
        "Jul-12",
        "Jun-12",
        "May-12",
        "Apr-12",
        "Mar-12",
        "Feb-12",
        "Jan-12",
        "Dec-11",
        "Nov-11",
        "Oct-11",
        "Sep-11",
        "Aug-11",
        "Jul-11",
        "Jun-11",
        "May-11",
        "Apr-11",
        "Mar-11",
        "Feb-11",
        "Jan-11",
        "Dec-10",
        "Nov-10",
        "Oct-10",
        "Sep-10",
        "Aug-10",
        "Jul-10",
        "Jun-10",
        "May-10",
        "Apr-10",
        "Mar-10",
        "Feb-10",
        "Jan-10",
        "Dec-09",
        "Nov-09",
        "Oct-09",
        "Sep-09",
        "Aug-09",
        "Jul-09",
        "Jun-09",
        "May-09",
        "Apr-09",
        "Mar-09",
        "Feb-09",
        "Jan-09",
        "Dec-08",
        "Nov-08",
        "Oct-08",
        "Sep-08",
        "Aug-08",
        "Jul-08",
        "Jun-08",
        "May-08",
        "Apr-08",
        "Mar-08",
        "Feb-08",
        "Jan-08",
        "Dec-07",
        "Nov-07",
        "Oct-07",
        "Sep-07",
        "Aug-07",
        "Jul-07",
        "Jun-07",
        "May-07",
        "Apr-07",
        "Mar-07",
        "Feb-07",
        "Jan-07",
        "Dec-06",
        "Nov-06",
        "Oct-06",
        "Sep-06",
        "Aug-06",
        "Jul-06",
        "Jun-06",
        "May-06",
        "Apr-06",
        "Mar-06",
        "Feb-06",
        "Jan-06",
        "Dec-05"
    ];
    private data = [
        ["Global Inflation",5.9,5.8,5.5,5.3,4.8,4.5,4.3,4.0,4.1,3.8,4.4,4.4,4.2,4.1,4.5,4.4,4.5,4.5,4.2,4.0,3.8,3.9,3.6,4.0,4.4,4.3,4.7,4.9,5.2,5.2,5.0,5.0,4.9,4.7,4.7,4.6,4.3,4.0,4.4,4.3,3.9,3.6,3.4,2.8,3.4,3.4,3.6,3.3,3.5,3.8,3.7,3.6,3.5,3.6,3.9,4.4,4.6,4.6,4.7,4.8,5.7,5.9,6.1,6.4,6.2,6.8,6.7,6.8,6.8,6.8,6.8,6.1,5.7,5.6,5.4,5.0,5.0,4.7,4.5,4.5,4.5,4.2,3.9,4.0,3.4,3.3,3.1,2.7,2.5,2.5,2.3,2.3,1.9,2.4,2.4,2.3,3.9,4.6,5.5,6.3,6.9,7.1,6.7,6.6,6.7,6.9,7.0,7.1,5.9,5.8,5.5,5.5,5.6,5.9,5.7,5.6,5.4,5.1,4.9,5.0,5.2,5.4,5.8,6.9,7.1,7.4,7.0,7.0,6.8,6.3,6.5,6.3],
        ["Global Manufacturing",6.3,6.3,5.1,4.7,5.5,4.0,3.4,3.6,4.1,2.9,4.2,3.5,4.0,4.5,3.1,3.0,3.4,4.4,3.8,3.6,4.7,4.8,4.4,4.5,4.6,5.3,5.2,4.4,7.4,5.9,4.7,4.9,4.5,5.7,4.7,5.5,6.0,5.7,7.3,6.8,3.9,6.9,6.0,5.3,4.1,7.3,4.6,6.1,4.3,5.8,5.9,3.3,5.6,4.2,5.0,4.6,5.1,5.1,4.4,5.6,4.7,4.6,3.3,4.8,4.7,4.3,5.5,4.7,6.6,4.6,7.2,5.5,6.6,5.6,6.4,6.4,5.9,5.9,5.6,6.4,6.6,5.2,7.9,5.3,5.9,6.0,5.9,5.8,6.5,5.0,5.7,4.1,4.1,2.7,0.6,0.7,0.4,-0.5,0.3,3.0,3.5,3.8,3.7,4.5,3.9,3.9,4.0,5.1,5.8,6.2,4.6,4.5,4.9,6.2,5.7,5.5,5.5,6.2,3.8,5.6,5.3,3.0,6.4,5.5,4.5,4.9,5.3,4.3,5.8,6.0,4.1,4.6],
        ["Global Service",4.7,4.7,3.6,2.9,3.7,3.9,3.0,3.6,3.5,2.9,4.4,4.4,5.3,5.8,4.7,6.4,6.7,5.5,6.1,6.6,6.0,5.5,5.2,5.2,5.7,5.2,7.0,7.2,6.6,7.3,6.3,5.1,5.6,3.6,5.1,4.0,4.8,5.1,3.9,8.9,6.3,4.8,4.6,4.2,6.4,7.2,6.1,7.1,5.8,4.5,5.1,2.9,2.2,3.8,4.6,4.6,5.9,6.0,6.4,3.8,4.3,4.1,3.9,5.0,5.1,5.7,6.2,6.5,6.8,7.5,7.6,7.7,7.7,7.5,7.0,6.7,7.6,7.8,8.3,8.5,7.8,6.8,6.2,6.5,6.1,6.8,6.5,5.8,4.8,4.7,3.5,3.1,1.6,1.7,2.1,0.4,-1.7,0.1,2.8,3.6,3.0,1.5,3.7,3.9,2.0,2.1,-2.1,2.5,2.3,2.9,2.2,2.2,2.6,4.2,3.4,2.4,1.5,2.8,3.5,1.5,2.1,2.1,2.0,0.5,1.6,1.4,3.8,5.5,4.3,3.9,1.5,5.5],
        ["Global Trade",5.0,5.0,5.1,5.1,3.2,4.6,4.2,4.4,4.8,5.8,5.5,6.0,6.8,6.9,6.8,6.8,7.0,7.0,6.7,7.0,6.9,7.4,7.7,7.7,7.5,7.5,7.7,7.3,7.4,7.2,7.3,7.4,7.3,7.5,7.9,7.3,6.9,6.8,6.3,6.8,6.7,6.3,6.5,6.5,6.5,6.1,6.8,6.0,6.2,5.9,6.5,6.1,6.1,6.3,6.6,5.7,6.1,5.8,5.7,6.6,6.9,6.9,6.9,7.0,6.9,6.9,7.1,7.0,7.2,7.2,7.4,7.6,6.5,6.5,6.2,6.1,6.0,5.9,5.4,5.2,5.0,4.6,4.5,4.5,3.9,3.8,3.7,2.9,2.8,2.6,1.9,1.8,1.6,2.0,1.6,1.5,3.6,5.2,5.4,6.0,6.2,5.9,6.4,6.5,6.3,6.6,6.8,6.6,7.5,7.5,7.3,7.4,7.3,7.3,7.3,7.3,7.4,7.4,7.4,7.0,6.5,6.4,6.5,6.5,6.4,6.7,6.8,6.8,7.0,6.8,6.8,7.0],
        ["Global Liquidity",5.4,5.9,5.4,5.7,5.6,6.8,5.8,6.4,6.2,8.7,8.3,6.4,6.2,6.7,8.7,9.6,7.5,8.1,6.7,6.3,5.8,3.9,4.4,4.2,3.3,3.3,2.9,2.6,2.4,1.6,2.1,1.6,1.0,2.0,2.6,1.8,2.8,2.7,3.2,3.8,3.1,3.7,3.5,3.1,3.7,4.1,4.0,4.6,4.7,5.1,5.2,6.2,6.1,6.6,8.1,7.4,7.5,7.2,7.6,8.6,8.3,7.4,8.8,7.5,5.3,3.8,3.7,3.0,3.1,3.0,3.2,3.9,3.7,3.2,3.1,3.8,3.8,6.7,6.3,5.1,4.3,4.9,5.0,4.8,4.1,4.3,4.3,5.4,6.1,7.7,5.4,5.1,5.7,7.1,7.5,9.8,10.1,12.1,13.4,5.8,5.5,6.9,5.4,5.1,9.0,8.2,6.4,12.5,8.3,5.2,7.1,1.8,7.9,6.5,1.3,4.4,5.6,0.3,-1.3,3.1,0.5,2.2,4.0,1.9,4.2,3.1,4.2,2.1,3.2,1.1,3.2,4.5],
        ["Global Consumer Spending",5.7,5.7,5.6,4.7,5.6,5.5,5.8,8.3,5.9,5.1,5.0,6.6,5.5,5.3,5.4,5.8,5.8,5.1,6.7,6.2,7.5,5.3,4.8,6.3,6.0,6.9,5.3,7.0,5.5,6.4,5.4,6.6,8.9,6.1,5.5,7.5,6.0,5.7,5.7,4.4,4.4,4.2,3.8,3.8,3.9,3.9,4.3,5.3,3.2,3.5,4.2,3.6,3.9,2.1,3.0,4.5,4.1,4.7,5.7,5.0,3.6,5.1,5.0,4.6,5.1,4.2,5.1,5.9,6.5,5.2,6.1,7.4,6.2,6.5,5.2,6.2,5.5,4.9,4.7,5.1,6.2,3.8,4.6,6.8,4.1,4.5,2.7,5.3,4.0,4.0,3.7,4.2,3.9,2.9,4.5,4.2,2.7,2.8,2.6,4.1,4.6,5.6,5.9,6.4,6.7,4.0,5.7,7.0,6.6,5.3,5.4,6.0,5.7,4.7,5.7,6.4,6.4,5.0,5.8,8.1,4.9,5.3,4.7,5.0,6.3,5.1,5.3,6.5,6.1,4.7,6.2,7.4],
        ["Global Housing Prices",4.8,4.8,4.8,5.5,4.8,3.6,3.1,2.7,5.3,3.3,3.3,3.6,4.1,3.6,4.7,2.9,5.3,3.3,4.1,5.5,3.3,4.6,2.1,5.5,5.1,6.4,5.2,4.8,7.0,5.5,5.2,6.7,5.8,4.7,6.2,6.1,5.1,5.3,6.4,5.5,5.1,6.6,6.9,5.0,7.8,7.2,6.5,6.6,6.3,6.0,5.8,5.7,5.3,5.4,5.3,5.9,6.3,5.7,3.8,5.7,5.1,4.8,6.5,5.8,6.6,6.8,5.8,7.6,5.5,5.9,6.3,6.1,6.5,6.9,6.0,6.2,6.3,4.7,6.6,6.6,6.6,4.6,6.2,4.8,4.8,5.2,5.3,4.8,5.0,5.3,5.0,4.7,4.1,4.8,5.2,3.4,3.2,4.1,4.9,4.7,4.8,5.8,6.9,6.2,6.0,6.5,6.3,6.4,6.5,6.1,7.2,6.0,6.1,5.6,5.6,4.6,5.7,4.5,6.0,4.9,4.2,4.3,4.5,4.4,4.5,3.8,5.0,4.7,4.8,4.4,4.7,5.0],
        ["Global Investor Sentiment",6.2,4.4,5.0,5.2,6.7,7.5,4.0,5.0,5.4,6.3,4.2,5.1,5.8,6.6,5.3,5.2,3.4,4.5,3.1,2.7,4.9,6.4,6.3,6.6,7.4,6.8,4.7,5.9,2.0,2.9,3.5,3.0,3.3,4.8,4.5,6.8,6.5,5.6,5.4,4.3,6.7,2.5,2.9,2.6,3.8,2.8,5.5,5.5,5.8,4.4,5.8,5.7,3.8,3.4,3.6,4.0,5.6,6.5,7.3,5.3,4.9,6.8,5.4,4.1,3.5,3.5,1.5,3.9,3.7,4.0,5.2,6.6,7.7,8.8,6.7,3.3,5.0,4.3,3.3,3.6,3.3,3.3,3.0,5.8,5.8,3.6,4.8,4.6,6.8,6.2,5.2,6.9,7.9,5.3,2.6,3.4,5.5,6.4,5.2,5.0,5.7,3.9,4.4,6.2,6.2,5.1,3.3,4.2,3.4,3.8,6.6,6.1,6.7,7.9,6.7,6.3,5.6,8.7,6.4,7.1,7.3,7.6,7.6,6.6,6.1,5.3,5.9,6.9,5.1,6.0,3.7,5.7],
        ["Macro Score",5.5,5.4,5.0,4.8,5.0,5.0,4.1,4.7,4.7,4.7,4.8,4.9,5.2,5.4,5.3,5.5,5.4,5.3,5.2,5.3,5.4,5.1,4.8,5.4,5.4,5.7,5.4,5.6,5.6,5.5,5.2,5.1,5.4,5.1,5.4,5.6,5.6,5.3,5.6,5.9,5.3,5.0,4.9,4.4,5.0,5.3,5.2,5.5,4.9,4.8,5.2,4.6,4.5,4.4,4.9,5.0,5.6,5.6,5.5,5.5,5.2,5.5,5.4,5.4,5.4,5.3,5.3,5.7,5.9,5.6,6.2,6.4,6.3,6.3,5.8,5.6,5.8,5.7,5.7,5.8,5.8,4.9,5.4,5.5,5.1,4.9,4.8,4.9,5.0,4.9,4.2,4.1,3.8,3.6,3.2,3.1,3.3,4.1,4.8,4.7,4.8,5.0,5.3,5.6,5.6,5.3,4.7,6.3,5.7,5.3,5.8,5.0,5.9,6.1,5.3,5.4,5.5,5.0,4.6,5.4,4.6,4.6,5.3,4.7,5.1,4.8,5.4,5.5,5.5,5.0,4.8,5.7],
        ["MSCI WORLD",5.3,5.0,6.1,5.9,6.0,3.9,4.4,4.3,3.6,0.5,0.3,3.4,4.6,5.2,1.4,3.6,7.1,6.5,7.5,7.7,7.1,7.9,6.3,7.0,7.6,7.2,7.1,8.1,7.8,8.5,8.3,8.2,8.3,8.7,7.9,9.3,9.2,9.2,8.7,7.8,8.8,7.8,8.8,9.5,8.9,8.5,8.7,7.1,6.6,6.2,6.7,5.9,5.2,5.0,3.7,6.5,7.0,6.8,5.6,4.3,4.4,5.2,2.6,5.1,7.2,7.8,8.4,9.2,8.3,8.6,8.1,8.0,7.0,7.6,7.1,5.6,6.0,4.7,5.0,6.0,5.9,5.2,4.9,5.2,4.9,4.5,4.5,4.1,3.7,3.0,2.9,2.2,1.3,0.3,0.4,0.3,-1.1,-2.2,-1.4,1.5,2.0,2.9,5.6,5.4,4.2,4.6,4.9,7.1,7.6,8.8,8.4,7.5,7.7,8.7,9.3,9.2,8.5,8.5,9.1,9.4,9.4,9.2,8.4,8.2,7.7,7.7,8.0,9.4,9.1,9.1,9.7,8.9],
        ["World GDP (YoY %)",3.6,3.6,3.6,2.9,2.9,2.9,2.3,2.3,2.3,2.7,2.7,2.3,2.3,2.3,1.9,1.9,1.9,2.0,2.0,2.0,2.0,5.0,5.0,5.5,7.2,7.2,7.5,6.4,6.4,6.6,4.6,4.6,4.5,7.2,7.2,7.2,7.2,7.2,7.2,4.7,4.7,4.7,4.4,4.4,4.4,2.3,2.3,2.3,2.9,2.9,2.9,1.5,1.5,1.5,2.4,2.4,2.4,3.7,3.7,4.4,5.8,5.8,6.0,5.3,5.3,5.7,5.3,5.3,5.7,6.4,6.4,6.6,7.0,7.0,7.1,7.7,7.7,7.6,7.6,7.6,7.5,6.7,6.7,6.7,4.4,4.4,4.4,3.6,3.6,3.6,1.4,1.4,1.4,0.5,0.5,0.5,1.1,1.1,1.1,2.3,2.3,2.3,1.1,1.1,1.1,3.9,3.9,4.2,5.0,5.0,5.2,6.1,6.1,6.3,5.2,5.2,5.5,8.1,8.1,8.3,4.2,4.2,4.1,5.3,5.3,5.5,9.7,9.7,9.9,5.0,5.0,5.0]
    ];
}